"use strict";var datahub_config={amplitude:true};var wuSessionStorage=window.sessionStorage;var previousPageName=null;var oldURL="";var oldPageName="";var oldCountryCode="";var oldFundsOut="";var oldFundsIn="";var dealsArr={};var mercId="";var merName="";var userIdRw="";var src_parameter=sessionStorage.getItem("src_code")?sessionStorage.getItem("src_code"):getURLParameter("src");var ampUTMObj=window.amplitude&&getAmplitudeUTMParameterCapture();var ampReferrerObj=getAmplitudeReferrer();var cloudPricingAPI="cloud-pricing/pricing/priceCatalog";var cloudPromoPricingAPI="cloud-promo/PromoAPI/get_promo_discount";var lookupAPI="/v2/lookup";const VISIT_EVENT_PROPS=["ab_test","ab_test_variant","current_url","user_pricing_session","wu_device_id","device_id","logged_in","page_name","partner_name","prz_clickref_id","sender_country","session_id","src_parameter","utm_campaign","utm_medium","utm_content","utm_source","utm_term","wu_platform","wu_device_type"];var hadoopAnalyticsApiEvents={api_CustomerSignOn:"Login completed",api_SendMoneyValidation:"Send money validation completed"};var hadoopAnalyticsClickEvents={"clicked_[home]_[button-send-money]":"clicked_[home]_[button-send-money]","clicked_[home]_[button-hero-login_signup]":"clicked_[home]_[button-hero-login_signup]","clicked_[history]_[button-start-new-transfer]":"clicked_[history]_[button-start-new-transfer]","clicked_[session-expired]_[button-login]":"Login attempted"};var hadoopAnalyticsPageLoadEvents={page_history:"page_history"};function isFeatureEnabled(feature,senderCountry){try{var featureFlags=JSON.parse(sessionStorage.getItem("featureFlags")||"{}");var Obj=featureFlags[feature].countries;return Obj==="ALL"||Obj.indexOf(senderCountry)>-1?true:false}catch(error){return false}}var customerId;function logEvents(eventType,eventInfo){amplitude.getInstance().logEvent(eventType,eventInfo)}function setUserId(userId){amplitude.getInstance().setUserId(userId)}function findMparticleState(){if(pageData.env.includes("mywu")){return JSON.parse(window.pageData.R4_DEPLOYED_COUNTRIES).indexOf(window.pageData.country)===-1?"r3mparticle":"r4mparticle"}else if(pageData.env.includes("blog")){let dataCategoryType=document.querySelector(".category-name")?.getAttribute("data-category-slug");if(dataCategoryType?.length!==2){dataCategoryType=getCookie("AKCountry")||"US"}const countryBlog=dataCategoryType?.toUpperCase();return JSON.parse(window.pageData.R4_DEPLOYED_COUNTRIES).indexOf(countryBlog)===-1?"r3mparticle":"r4mparticle"}let stateMParticle=window.pageData.dataCountryThemeSetting&&window.pageData.dataCountryThemeSetting.nodes[0].countryThemeSettings.mParticle.stateMParticle;const enableNextGenWeb=CookieService.getCookie("enableNextGenWeb");if(stateMParticle==="r3mparticle"&&enableNextGenWeb==="true")return"r4mparticle";return stateMParticle}function isR4Mparticle(){const stateMParticle=sessionStorage.getItem("stateMParticle")||findMparticleState();return!!(stateMParticle==="r4mparticle"&&window.mParticle&&window.mParticleLogEvent)}function updateWULanguage(){if(getCookieValue("WULanguageCookie_")){var wu_language=getCookieValue("WULanguageCookie_");var identify=(new amplitude.Identify).set("wu_language",wu_language);amplitude.getInstance().identify(identify)}}function setCookieInMinutes(cname,cvalue,exminutes){var d=new Date;d.setTime(d.getTime()+exminutes*60*1e3);var expires="expires="+d.toUTCString();var cookie=cname+"="+cvalue+";"+expires+";path=/;";if(window.location.protocol.indexOf("https")!==-1){cookie+="secure;"}document.cookie=cookie}function nestedObj(obj,find){try{if(typeof obj==="object"&&!Array.isArray(obj)&&obj!==null){if(obj[find])return obj[find];const keys=Object.keys(obj);for(let i=0;i<keys.length;i++){let res=nestedObj(obj[keys[i]],find);if(res!==undefined)return res}}}catch(e){console.error(e)}}function setRAFAttribute(eventInfo){const isTnCAccepted=JSON.parse(sessionStorage.getItem("RAFTnCAccept")||"false")?true:false;eventInfo["raf_registration_page"]=_get(eventInfo,"utm_campaign")==="saasquatch"&&isTnCAccepted?"yes":"no"}function _get(object,path,defval=null){if(typeof path==="string")path=path.split(".");return path.reduce(((xs,x)=>xs&&xs[x]?xs[x]:defval),object)}var PSCSAPIMappping={"/SessionKeepAlive":"/GwpSessionKeepAlive","/CreateSession":"/GwpCreateSession","/EmailValidation":"/GwpValidateEmail","/RegisterCustomer":"/GwpRegisterCustomer","/ValidateToken":"/GwpValidateToken","/ValidateWYHFactors":"/GwpValidateWYHFactors","/GetVerifyWYHFactors":"/GwpGetVerifyWYHFactors","/GetSupportedWYKFactors":"/GwpGetSupportedWYKFactors","/SavePassword":"/GwpSavePassword","/TerminateSession":"/GwpTerminateSession","/GetLoyaltyCards":"/GwpGetLoyaltycards","/ValidateWYKFactors":"/GwpValidateWYKFactors","/RedeliverToken":"/GwpRedeliverToken","/GetLimits":"/GwpGetLimits","/GetTransactionDetails":"/GwpGetTransactionDetails","/CustomerSignOn":"/GwpCustomerSignon","/GetCustomerVerificationStatus":"/GwpGetCustomerVerificationStatus","/GetReceivers":"/GwpGetReceivers","/GetBanks":"/GwpGetBanks","/CreateFXAlerts":"/GwpCreateFXAlerts","/GetFXAlerts":"/GwpGetFXAlerts","/UpdateFXAlerts":"/GwpUpdateFXAlerts","/GetCreditCards":"/GwpGetCreditcards","/AddReceivers":"/GwpAddReceivers","/AddCreditCards":"/GwpAddCreditcards","/DeleteCreditCards":"/GwpDeleteCreditcards","/UpdateCreditCards":"/GwpUpdateCreditcards","/AddBanks":"/GwpAddBanks","/GetCustomerProfile":"/GwpGetCustomerProfile","/UpdateCustomerProfile":"/GwpUpdateCustomerProfile","/TransactionInquiry":"/GwpTransactionInquiry","/GetCustomerStatus":"/GwpGetCustomerStatus","/UpdateReceivers":"/GwpUpdateReceivers","/SendMoneyValidation":"/GwpSendMoneyValidation","/ExtractOCR":"/GwpExtractOCR","/SignUpAsLead":"/GwpSignUpAsLead","/VerifyKYCData":"/GwpVerifyKYCData","/GetNonDigitalTxns":"/GwpGetNonDigitalTxnHistory","/AuthenticateCustomer":"/AuthenticateCustomer","/GetQuestionnaireAndPendingDocs":"/GetQuestionnaireAndPendingDocs","/GetIdVerificationStatus":"/GwpGetIdVerificationStatus","/SubmitQuestionnaire":"/SubmitQuestionnaire","/MobileReload":"/GwpMobileReload","/UploadDMSDoc":"/GwpUploadDMSDoc","/GetIFSC":"/GwpGetIFSCCode","/SaveOCRData":"/GwpSaveOCRData","/VendorInfo":"/GwpGetVendorInfo","/GetQRCode":"/GwpGetQRCode","/GetSelfieInitiated":"/GwpGetSelfieInitiated","/GetRAFProfile":"/GwpGetRAFProfile"};function renameGwpApi(method){for(const key in PSCSAPIMappping){if(PSCSAPIMappping.hasOwnProperty(key)){if(method===PSCSAPIMappping[key]){method=key;break}}}return method}function getFetchName(method){if(method===cloudPricingAPI||method===cloudPromoPricingAPI||method===lookupAPI){return method.split("/")[2]}else if(method.indexOf("/v1/authorize")!==-1||method.indexOf("/v1/token")!==-1){return method.split("/")[2].split("?")[0]}else{return method.split("/")[1]}}function logAPIEvent(method,request,response,channel){const ignoreList=["GetDatabase","AddRewardsToCustomerWallet","AuthenticateCustomer","AvailableKYCOptions","GetPaymentInstruments","Languages","PayoutCommit","RetailCustomerLookUp","SendMobileAppMail","VerifyPhone"];if(method.indexOf("Gwp")>-1){method=renameGwpApi(method)}let methodName="";const fetchName=method?getFetchName(method):"";if(channel==="retail"){methodName="api_Retail"+fetchName}else{methodName="api_"+fetchName}if(ignoreList.indexOf(fetchName)===-1){const apiAttributes={api_name:fetchName,api_response_code:_get(response,"error.code",0)||nestedObj(response,"errorCode")||0,api_response_message:null};if(apiAttributes.api_response_code!==0){apiAttributes["api_response_message"]=_get(response,"error.message")||nestedObj(response,"message")||"Response message is not available"}if(fetchName==="RegisterCustomer"&&response&&!window.location.origin.startsWith("https://www.")){if(response.Status&&response.Status.code===0){const clickEventAttr={...mandatoryAttributes(),...optionalAttributes()};logEvents("CompleteRegistration",clickEventAttr)}}if(fetchName==="RegisterCustomer"){if(sessionStorage.getItem("crossCountryRedirectionError")){apiAttributes["multipleProfile"]=true}}if(fetchName==="CustomerSignOn"||fetchName==="RegisterCustomer"){apiAttributes["pricing_campaign"]=request&&request["campaign"]&&request["campaign"]["campaign_name"]?request["campaign"]["campaign_name"]:"";apiAttributes["subscription_id"]=request&&request["campaign"]&&request["campaign"]["subscription_id"]?request["campaign"]["subscription_id"]:"";apiAttributes["pricing_campaign_response"]=response&&response["subscription"]&&response["subscription"]["campaign_name"]?response["subscription"]["campaign_name"]:"";apiAttributes["subscription_id_response"]=response&&response["subscription"]&&response["subscription"]["subscription_id"]?response["subscription"]["subscription_id"]:"";apiAttributes["subscription_expiry_date"]=response&&response["subscription"]&&response["subscription"]["end_date"]?new Date(response["subscription"]["end_date"]).toISOString():""}if(fetchName==="catalog"){apiAttributes["receiver_country"]=request&&request["receiver"]&&request["receiver"]["cty_iso2"]?request["receiver"]["cty_iso2"].toLowerCase():"";apiAttributes["pricing_campaign"]=request&&request["campaign"]&&request["campaign"]["campaign_name"]?request["campaign"]["campaign_name"]:"";apiAttributes["subscription_id"]=request&&request["campaign"]&&request["campaign"]["subscription_id"]?request["campaign"]["subscription_id"]:"";apiAttributes["pricing_segment"]=response&&response["sender"]&&response["sender"]["segment"]?response["sender"]["segment"]:"";apiAttributes["subscription_expiry_date"]=CookieService.getCookie("promoCampaignSubscriptionEndDate");if(getURLParameter("promocampaign")){apiAttributes["user_pricing_campaign"]=getURLParameter("user")?getURLParameter("user"):"";apiAttributes["pricing_campaign_link"]=getURLParameter("promocampaign")}const userType=CookieService.getCookie("userIdentity")?CookieService.getCookie("userIdentity"):"";if(userType){apiAttributes["user_pricing_session"]=userType}if(_get(response,"response_status.status")===-1){apiAttributes["api_response_code"]=_get(response,"response_status.code")||nestedObj(response,"errorCode");apiAttributes["api_response_message"]=_get(response,"response_status.message")||nestedObj(response,"message")||"Response message is not available"}}if(fetchName==="partialRegisterCustomer"){apiAttributes["registration_type"]="receiver"}function ampUserIdRd(accn){userIdRw=accn&&accn.length<10?md5Encryption(accn):accn;if(userIdRw)setUserId(userIdRw)}if(fetchName==="bonusCampaignApi"){apiAttributes["bonus-campaign-names"]="name";if(userIdRw.length==0){var accn=request&&request.split('"')[3];ampUserIdRd(accn)}}if(fetchName==="transHistoryApi"){apiAttributes["trans_history"]="records"}if(fetchName==="ShopallDeals"){apiAttributes["shopallDeals"]="shopDeals"}if(fetchName==="ShopAllBrands"){apiAttributes["shopAllBrands"]="shopBrands"}if(fetchName==="ShopMerchantDetails"){apiAttributes["shopMerchantDetails"]="shopMerchDetails"}if(fetchName==="ShopMerchantUrl"){apiAttributes["shopMerchantUrl"]="shopMerchUrl"}if(fetchName==="ShopAccessToken"){apiAttributes["shopAccessToken"]="shopAccToken";if(userIdRw.length==0){const custData=sessionStorage.getItem("mywuApp");const parData=custData&&JSON.parse(custData);var accn=parData&&parData.customer.accountNumber;ampUserIdRd(accn)}}Object.keys(apiAttributes).forEach((key=>{if(apiAttributes[key]===""||apiAttributes[key]===null){delete apiAttributes[key]}}));const eventInfo={...mandatoryAttributes(),...optionalAttributes(),...apiAttributes};setUtmSrcParameter(eventInfo);setReferrerParameter(eventInfo);if(fetchName==="RegisterCustomer"){setRAFAttribute(eventInfo);sessionStorage.removeItem("RAFTnCAccept")}if(sessionStorage.getItem("userSelectedCountry")){eventInfo["user_selected_country"]=sessionStorage.getItem("userSelectedCountry")?.toLowerCase()}if(sessionStorage.getItem("currentFlow")){eventInfo["user_action"]=sessionStorage.getItem("currentFlow")}if(sessionStorage.getItem("loginType")){eventInfo["login_mode"]=sessionStorage.getItem("loginType")}if(window.amplitude){logEvents(methodName,eventInfo)}else{window.mParticleLogEvent(methodName,methodName,eventInfo)}}}function getAnalyticsData(){var data={};Object.assign(data,mandatoryAttributes(),optionalAttributes());return data}function getHadoopAnalyticsEventsData(){var hadoopEventAnalyticsEvents={};Object.assign(hadoopEventAnalyticsEvents,hadoopAnalyticsApiEvents,hadoopAnalyticsClickEvents,hadoopAnalyticsPageLoadEvents);return hadoopEventAnalyticsEvents}function getXHRApiData(module,request,response){var xhrListArray=["CreateSession","GetDatabase","ValidateEmail","RegisterCustomer"];if(module){module=module.replace(/^\//,"");if(module.indexOf("?")!==-1){module=module.substring(0,module.indexOf("?"))}if(xhrListArray.indexOf(module)===-1){var xhrApiJson={};if(response.error){xhrApiJson=handleAPIErrorResponse(module,response,request)}else{xhrApiJson=handleAPISuccessResponse(module,request,response)}var ignoreSummaryObjList=["history","send-money-option","price-estimator"];if(wuSessionStorage&&ignoreSummaryObjList.indexOf(wuSessionStorage.page_name)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false)}checkNameChangeCancelTransferFlow();var analyticsData=getAnalyticsData();sessionStorage.removeItem("wuAmplitude_useSummaryObj");sessionStorage.removeItem("wuAmplitude_useNameChangeObj");sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");var adKeys=Object.keys(analyticsData);adKeys.sort();for(var i=0;i<adKeys.length;i++){if(adKeys[i]){xhrApiJson[adKeys[i]]=analyticsData[adKeys[i]]}}sendAnalyticsData(xhrApiJson,request,response,module)}}}function getOptimusApiData(requestName,requestBody,response){if(requestName){var module,xhrApiJson={};xhrApiJson=response.error?handleAPIErrorResponse(requestName,response,requestBody):handleAPISuccessResponse(requestName,requestBody,response);var analyticsData=getAnalyticsData();var adKeys=Object.keys(analyticsData);adKeys.sort();for(var i=0;i<adKeys.length;i++){if(adKeys[i]){xhrApiJson[adKeys[i]]=analyticsData[adKeys[i]]}}module="biller.optimus.json";sendAnalyticsData(xhrApiJson,requestName,response,module)}}function checkforSubErrorCode(response){var subErrorCode=[];try{var reasonResp=response&&response.error&&response.error.reasons?response.error.reasons.reason:null;if(reasonResp){angular.forEach(reasonResp,(function(reason){if(reason&&reason.code){subErrorCode.push(reason.code)}}))}}catch(e){}return subErrorCode}function handleAPIErrorResponse(module,response,request){var childErrorCode=checkforSubErrorCode(response);var data={api_name:module,api_response_code:response.error.code||"Error code is not available",api_response_message:response.error.message.toLowerCase()||"Error message is not available"};if(childErrorCode.length>0){data["api_response_child_code"]=childErrorCode}var isSofRequired=sessionStorage.getItem("sof_doc_requested")||null;if(isSofRequired){data["sof_doc_requested"]=JSON.parse(sessionStorage.getItem("sof_doc_requested"))==true?"y":"n"}else{data["sof_doc_requested"]="n"}if(module==="FeeInquiryEstimated"){sessionStorage.removeItem("wuAmplitudeSMO_sendReceiveLock");getSendReceiveLock(request);getSMOReceiverCountry(request);getSMOFundsOut();getSMOFundsIn();getBiller(request);getSendAmount(request)}if(module==="SendMoneyStore"&&response.error.code==="C2001"){if(response.sender&&response.sender.kycDetails){data["kyc_option"]=Object.getOwnPropertyNames(response.sender.kycDetails).join();var kycOptionsArr=data.kyc_option.split(",");var index=kycOptionsArr.indexOf("pbv");if(index!==-1){kycOptionsArr.splice(index,1)}var allKycOptions=Object.getOwnPropertyNames(response.sender.kycDetails).join();if(response.sender.kycDetails.pbv&&response.sender.kycDetails.pbv.deliveryMethods&&response.sender.kycDetails.pbv.deliveryMethods.voiceDelivery){kycOptionsArr.unshift("pbv-voice")}if(response.sender.kycDetails.pbv&&response.sender.kycDetails.pbv.deliveryMethods&&response.sender.kycDetails.pbv.deliveryMethods.smsDelivery){kycOptionsArr.unshift("pbv-sms")}if(response.sender.kycDetails.pbv&&response.sender.kycDetails.pbv.deliveryMethods&&response.sender.kycDetails.pbv.deliveryMethods.emailDelivery){kycOptionsArr.unshift("pbv-email")}data["kyc_option"]=kycOptionsArr.join(",")}}if(module==="SendMoneyStore"&&_.has(response,"sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument")){var docs=response.sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument;var _result=docs.map((function(val){return val.docType==="ID"?val.docType+"-"+val.type:val.docType}));if(_result.length!=0){sessionStorage.setItem("wuAmplitude_kycDocTypes",_result);data["kyc_doc_count"]=_result.length;data["kyc_doc_type"]=_result}}if(module==="VerifyCustomer"&&response){if(sessionStorage.getItem("wuAmplitude_kycDocTypes")){sessionStorage.removeItem("wuAmplitude_kycDocTypes")}}if(_.has(request,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")){data["wu3ds_request"]=request.payment_details.credit_debit_card.cardinal_info.wu_3ds_version;data["cc3ds_request"]=request.payment_details.credit_debit_card.cardinal_info.cc_3ds_version}if(_.has(response,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")){data["wu3ds_response"]=response.payment_details.credit_debit_card.cardinal_info.wu_3ds_version;data["cc3ds_response"]=response.payment_details.credit_debit_card.cardinal_info.cc_3ds_version}if(_.has(response,"paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version")){data["wu3ds_response"]=response.paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version;data["cc3ds_response"]=response.paymentDetails.creditDebitCard.cardinalInfo.cc_3ds_version}if((module==="SendMoneyStore"||module==="SendMoneyValidation")&&(response.error.code==="C1974"||response.error.code==="C2002")){var SMOSMVDataError=getSMVSMO(module,request,response);if(response&&response.alternate_payment_types&&response.alternate_payment_types.payment_type){data["alt_payment"]=response.alternate_payment_types.payment_type}}if(module==="SendMoneyStore"){if(request&&request.store_type){data["store_type"]=request.store_type.toLowerCase()}request&&request.payment_details&&request.payment_details.card_updater_consent_flag?data["card_updater_consent_flag"]=request.payment_details.card_updater_consent_flag.toLowerCase():null}if(module==="VerifyCustomer"&&(response.error.code==="C9003"||response.error.code==="C9002"||response.error.code==="C9013")){data["kyc_option"]=sessionStorage.getItem("kyc_option")?sessionStorage.getItem("kyc_option"):null;sessionStorage.removeItem("kyc_option");if(request&&request.doc_info&&request.doc_info.length>0){data["doc_type"]=request.doc_info[0].dms_doc.doc_type}}if(module==="BillerOptimus"&&response.error&&response.error.code=="Biller Template"){data["api_response_code"]="NA"}if((module==="SendMoneyValidation"||module==="SendMoneyStore")&&(response&&response.error&&request&&request.payment_details&&request.payment_details.credit_debit_card&&request.payment_details.credit_debit_card.card_type)){data["card_type"]=request.payment_details.credit_debit_card.card_type}if(module==="AddCreditCards"){var cardConsentData=JSON.parse(sessionStorage.getItem("wuAmplitude_cardConsentData"));if(cardConsentData){sessionStorage.removeItem("wuAmplitude_cardConsentData");data["card_type"]=cardConsentData.cardType}}if(module==="UpdateCreditCards"&&response&&response.error&&request.gateway_customer){data["card_type"]=_.get(request,"gateway_customer.wallet.credit_debit_cards.credit_debit_card[0].card_type")}return data}function setSofToSession(module,request,response){var verificationStatus=JSON.parse(sessionStorage.getItem("CustomerVerificationStatus"))||{};try{if(_.has(verificationStatus,"verificationStatus.sender.compliance_details.sourceOfFunds")){sessionStorage.setItem("sof_doc_requested","true")}if(_.has(response,"additional_information.param")){var param=response.additional_information.param;var sf_requested_data=param.filter((function(e){return e.type=="sf_doc_requested"}));if(sf_requested_data&&sf_requested_data[0].value){sessionStorage.setItem("sof_doc_requested",sf_requested_data[0].value)}}}catch(err){console.error(err)}}function removeSofToSession(module,request,response){if(_.has(response,"moneyTransferControl.mtcn")&&sessionStorage.getItem("sof_doc_requested")){sessionStorage.removeItem("sof_doc_requested")}}setSofToSession();function handleEventLogging(resObj,prepareData){if(!resObj)return prepareData;if(!prepareData)return;var eventKeys=["is_id_available","is_id_expired","id_issuing_country","is_dob_present"];var newData={};eventKeys.forEach((function(key){if(resObj[key]){newData[key]=resObj[key]}}));return Object.keys(newData).length>0?_.extend(prepareData,newData):prepareData}function handleAPISuccessResponse(module,request,response){var prepareData={api_name:module,api_response_code:response.code||0};if(module==="SendMoneyValidation"){setSofToSession(module,request,response)}var isSofRequired=sessionStorage.getItem("sof_doc_requested")||null;if(isSofRequired){prepareData["sof_doc_requested"]=JSON.parse(sessionStorage.getItem("sof_doc_requested"))==true?"y":"n"}else{prepareData["sof_doc_requested"]="n"}if(prepareData.api_response_code!==0){prepareData["api_response_message"]=response.message.toLowerCase()||"Response message is not available"}if(module==="SendMoneyValidation"||module==="SendMoneyStore"){if(request&&request.store_type){prepareData["store_type"]=request.store_type.toLowerCase()}if(_.has(request,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")){prepareData["wu3ds_request"]=request.payment_details.credit_debit_card.cardinal_info.wu_3ds_version;prepareData["cc3ds_request"]=request.payment_details.credit_debit_card.cardinal_info.cc_3ds_version}if(_.has(response,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")){prepareData["wu3ds_response"]=response.payment_details.credit_debit_card.cardinal_info.wu_3ds_version;prepareData["cc3ds_response"]=response.payment_details.credit_debit_card.cardinal_info.cc_3ds_version}if(_.has(response,"paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version")){prepareData["wu3ds_response"]=response.paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version;prepareData["cc3ds_response"]=response.paymentDetails.creditDebitCard.cardinalInfo.cc_3ds_version}var SMOSMVData=getSMVSMO(module,request,response);if(module==="SendMoneyValidation"){if(response&&response.payment_details&&response.payment_details.paymentTypeIndicator){prepareData["payment_mismatch_flag"]="true"}if((request.payment_details.payment_type==="CreditCard"||request.payment_details.payment_type==="DebitCard")&&_.get(request,"payment_details.credit_debit_card.card_consent_flag")){prepareData["card_consent"]=request.payment_details.credit_debit_card.card_consent_flag.toLowerCase()}if(_.get(request,"receiver.address.country_iso_code")==="MX"&&sessionStorage.getItem("SelectedPayOutOption")==="BA"){prepareData["receiver_account_type"]=addReceiverAccountTypeForMexico(request.receiver)}if(_.get(response,"zumigo_session_id")){prepareData["zumigo_session_id"]=response.zumigo_session_id}if(_.get(request,"receiver.address.country_iso_code")==="IN"&&sessionStorage.getItem("SelectedPayOutOption")==="BA"){prepareData["funds_out"]=setFundsOutUpiAmplitudeData(request.receiver)}}if(module==="SendMoneyStore"){if(_.get(request,"receiver.address.country_iso_code")==="MX"&&sessionStorage.getItem("SelectedPayOutOption")==="BA"){prepareData["receiver_account_type"]=addReceiverAccountTypeForMexico(request.receiver)}request&&request.payment_details&&request.payment_details.card_updater_consent_flag?prepareData["card_updater_consent_flag"]=request.payment_details.card_updater_consent_flag.toLowerCase():null;removeSofToSession();var stObject=JSON.parse(sessionStorage.getItem("scheduledReminderObject"));if(!stObject){prepareData["reminder_enrol"]=true;prepareData["reminder_frequency"]=stObject["frequency_type"].toLowerCase()}if(_.get(request,"receiver.address.country_iso_code")==="IN"&&sessionStorage.getItem("SelectedPayOutOption")==="BA"){prepareData["funds_out"]=setFundsOutUpiAmplitudeData(request.receiver)}}Object.assign(prepareData,SMOSMVData)}if(module==="GetLoyaltyCards"&&GetLoyaltyCardsCampaigns(response)){prepareData.campaignids=GetLoyaltyCardsCampaigns(response)}if(module==="FeeInquiryEstimated"){sessionStorage.removeItem("wuAmplitudeSMO_sendReceiveLock");getSendReceiveLock(request);getSMOReceiverCountry(request);getSMOFundsOut();getSMOFundsIn();getBiller(request);getSendAmount(request)}if(module==="TransactionInquiry"){prepareData["redirectable-flag"]=response.statusDetails.isSenderRedirectable}if(module==="CustomerSignOn"){if(response.gatewayCustomer){if(response.gatewayCustomer.preferredCustomer&&response.gatewayCustomer.preferredCustomer.accountNbr){prepareData["customerSignOnAccountNumber"]=response.gatewayCustomer.preferredCustomer.accountNbr;sessionStorage.setItem("wuAmplitude_idvstatus",response.gatewayCustomer.identityVerificationStatus)}}var transactionCount=_.get(response,"gatewayCustomer.transactionCount");var lastTransactionDate=_.get(response,"gatewayCustomer.lastTransactionDate");var registrationDate=_.get(response,"gatewayCustomer.registrationDate");if(transactionCount){prepareData["total_transactions"]=transactionCount}if(lastTransactionDate){prepareData["last_transaction_date"]=lastTransactionDate;var differnceInMs=(new Date).getTime()-new Date(lastTransactionDate).getTime();var differnceInDays=differnceInMs/(1e3*3600*24);prepareData["days_since_last_transaction"]=Math.floor(differnceInDays)}if(registrationDate){prepareData["registration_date"]=registrationDate}}if(module==="CustomerSignOn"||module==="RegisterCustomer"){prepareData["pricing_campaign"]=request&&request["campaign"]&&request["campaign"]["campaign_name"]?request["campaign"]["campaign_name"]:"";prepareData["subscription_id"]=request&&request["campaign"]&&request["campaign"]["subscription_id"]?request["campaign"]["subscription_id"]:"";prepareData["pricing_campaign_response"]=response&&response["subscription"]&&response["subscription"]["campaign_name"]?response["subscription"]["campaign_name"]:"";prepareData["subscription_id_response"]=response&&response["subscription"]&&response["subscription"]["subscription_id"]?response["subscription"]["subscription_id"]:"";prepareData["subscription_expiry_date"]=response&&response["subscription"]&&response["subscription"]["end_date"]?new Date(response["subscription"]["end_date"]).toISOString():""}if(module==="SendMoneyValidation"){prepareData["pricing_campaign"]=_.get(request,"sender.campaign_name")?_.get(request,"sender.campaign_name"):undefined;prepareData["subscription_id"]=_.get(request,"sender.subscription_id")?_.get(request,"sender.subscription_id"):undefined;prepareData["pricing_campaign_response"]=_.get(response,"sender.campaign_name")?_.get(response,"sender.campaign_name"):undefined;prepareData["subscription_id_response"]=_.get(response,"sender.subscription_id")?_.get(response,"sender.subscription_id"):undefined;prepareData["subscription_expiry_date"]=_.get(response,"sender.end_date")?_.get(response,"sender.end_date"):undefined}if(module==="SendMoneyStore"&&_.has(response,"sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument")){var docs=response.sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument;var _result=docs.map((function(val){return val.docType==="ID"?val.docType+"-"+val.type:val.docType}));if(_result&&_result.length!=0){sessionStorage.setItem("wuAmplitude_kycDocTypes",_result);prepareData["kyc_doc_count"]=_result.length;prepareData["kyc_doc_type"]=_result}}if(module==="InitiateCustomerVerification"||module==="UploadDMSDoc"||module==="GetCustomerVerificationStatus"&&response){var _docFromSession=sessionStorage.getItem("wuAmplitude_kycDocTypes")||"";if(_docFromSession){var _docs=_docFromSession.split(",");if(_docs&&_docs.length!==0){prepareData["kyc_doc_count"]=_docs.length;prepareData["kyc_doc_type"]=_docs}}}if(module==="VerifyCustomer"&&response){if(sessionStorage.getItem("wuAmplitude_kycDocTypes")){sessionStorage.removeItem("wuAmplitude_kycDocTypes")}}if(module==="CancelPendingTransaction"){if(request&&request.reason_code){prepareData["cancel_reason"]=request.reason_code}}if(module==="GetCreditCards"&&getCount(module,response)){prepareData["card_count"]=getCount(module,response)}if(module==="GetBanks"&&getCount(module,response)){prepareData["bank_count"]=getCount(module,response)}if(module==="AddReceivers"&&getFundsOutOption()){if(sessionStorage.getItem("SelectedPayOutOption")==="WA"){prepareData["wallet_service_provider"]=request.receivers.receiver[0].wallet.wu_wallet.service_provider_name}else{var bankDetails=getReceiverBankDetails(request);Object.assign(prepareData,bankDetails)}}var SelectedPayout=sessionStorage.getItem("SelectedPayOutOption");if((module==="UpdateReceivers"||module==="AddReceivers")&&_.get(request,"receivers.receiver[0].address.country_iso_code")==="MX"&&SelectedPayout==="BA"){prepareData["receiver_account_type"]=addReceiverAccountTypeForMexico(request.receivers.receiver[0])}if((module==="UpdateReceivers"||module==="AddReceivers")&&_.get(request,"receivers.receiver[0].address.country_iso_code")==="IN"&&SelectedPayout==="BA"){prepareData["funds_out"]=setFundsOutUpiAmplitudeData(request.receivers.receiver[0])}if(module==="InitiateCustomerVerification"){if(request&&request.sender&&request.sender.compliance_details&&request.sender.compliance_details.id_documents&&request.sender.compliance_details.id_documents.id_document&&request.sender.compliance_details.id_documents.id_document.length>0){prepareData["doc_type"]=request.sender.compliance_details.id_documents.id_document[0].type}if(request&&request.sender&&request.sender.kyc_details){prepareData["kyc_option"]=Object.getOwnPropertyNames(request.sender.kyc_details).join();sessionStorage.setItem("kyc_option",prepareData.kyc_option);if(_.get(response,"sender.kyc_details")){var kyc=response.sender.kyc_details;var kycDocCount=0;var kycOption;prepareData["kyc_option"]=kycOption=Object.getOwnPropertyNames(kyc).join("")||null;if(kycOption){var docString=kycOption+"."+kycOption+"Delivery."+kycOption+"Documents."+kycOption+"document";var kycDocs=_.get(kyc,docString);if(kycDocs&&Array.isArray(kycDocs)&&kycDocs.length>0){prepareData["kyc_doc_type"]=kycDocs.map((function(doc){kycDocCount+=1;return doc.docType?doc.docType+"-"+doc.type:doc.type}))}prepareData["kyc_doc_count"]=kycDocCount}}if(request.sender.kyc_details.pbv){if(request.sender.kyc_details.pbv.delivery_methods&&request.sender.kyc_details.pbv.delivery_methods.voice_delivery){prepareData["kyc_option"]="pbv-voice"}else if(request.sender.kyc_details.pbv.delivery_methods&&request.sender.kyc_details.pbv.delivery_methods.sms_delivery){prepareData["kyc_option"]="pbv-sms"}else if(request.sender.kyc_details.pbv.delivery_methods&&request.sender.kyc_details.pbv.delivery_methods.email_delivery){prepareData["kyc_option"]="pbv-email"}}}}if(module==="ValidateCustomerVerification"){if(request&&request.sender&&request.sender.kyc_details){prepareData["kyc_option"]=Object.getOwnPropertyNames(request.sender.kyc_details).join()}}if(module==="VerifyCustomer"){prepareData["kyc_option"]=sessionStorage.getItem("kyc_option")?sessionStorage.getItem("kyc_option"):null;sessionStorage.removeItem("kyc_option");if(request&&request.doc_info&&request.doc_info.length>0){prepareData["doc_type"]=request.doc_info[0].dms_doc.doc_type}}if(module==="UploadDMSDoc"){if(request.doc_info&&request.doc_info.length>0&&request.doc_info[0].dms_doc&&request.doc_info[0].dms_doc.doc_sub_type){prepareData["doc_type"]=request.doc_info[0].dms_doc.doc_sub_type}}if(module==="BillerOptimus"){prepareData["template_id"]=response.billerCTRTemplate.TEMPLATE_ID}if(module==="GetTransactionDetails"){prepareData["execution_time"]=response["execution_time"]/1e3;prepareData["total_transactions"]=_.has(response,"transactions.transaction")?response.transactions.transaction.length:0;prepareData["api_version"]="v"+request["security"]["version"]}if(module==="oauth/authenticate"){var _id=response.config.headers?response.config.headers.client_id:"";var _partnerName=countryConfig&&countryConfig.ConfigTemplate&&countryConfig.ConfigTemplate.partner&&countryConfig.ConfigTemplate.partner.name;var _status=response.status===200?"0 (passed)":"1 (failed)";var _referenceId=sessionStorage.getItem("partnerRequestId")?sessionStorage.getItem("partnerRequestId"):null;prepareData["api_response_code"]=_status;prepareData["api_reponse_message"]=getResponseMsg(_partnerName,_status);prepareData["Partner_name"]=_partnerName;prepareData["Login_datetime"]=getTodayDate();prepareData["Country_Code"]=request.countryCode;prepareData["customer_reference_id"]=_referenceId}if(module==="AddCreditCards"){var cardConsentData=JSON.parse(sessionStorage.getItem("wuAmplitude_cardConsentData"));if(cardConsentData){sessionStorage.removeItem("wuAmplitude_cardConsentData");prepareData["card_type"]=cardConsentData.cardType.toLowerCase();prepareData["card_consent"]=cardConsentData.cardConsent.toLowerCase();prepareData["card_consent_default"]=cardConsentData.cardConsentDefault.toLowerCase();prepareData["card_consent_type"]=cardConsentData.cardConsentType.toLowerCase()}}if(module==="PostIDMSkycFormId"){prepareData["form_id"]=request["formId"];sessionStorage.removeItem("formId")}if(module==="data"){if(response&&response.data&&response.data.type){prepareData["type"]=response.data.type}}if(module==="addressLookup"){prepareData["char_count"]=request.address?request.address.length:0;prepareData["result_count"]=response&&response.data&&response.data.results?response.data.results.length:0}if(module==="IDCompliance/UpdateCompliance"&&response&&response.identityVerificationStatus){sessionStorage.setItem("_wuAnalyticIVS",response.identityVerificationStatus);prepareData["identity_verification_status"]=response.identityVerificationStatus;response.verificationSource?prepareData["verification_source"]=response.verificationSource:null;sessionStorage.setItem("_wuAnalyticIVSource",response.verificationSource)}if(module==="CreateScheduleReminders"){prepareData["reminder_enrol"]=true;prepareData["reminder_frequency"]=request["frequency_type"].toLowerCase();var stObject=JSON.parse(sessionStorage.getItem("scheduledReminderObject")||"{}");if(_.has(stObject,"reminder_page")){prepareData["reminder_page"]=stObject.reminder_page}}if(module==="UpdateCreditCards"&&request.gateway_customer){prepareData["card_type"]=_.get(request,"gateway_customer.wallet.credit_debit_cards.credit_debit_card[0].card_type")}return prepareData}function getCount(module,response){var count=0;if(module==="GetCreditCards"&&response.gatewayCustomer&&response.gatewayCustomer.creditDebitCards&&response.gatewayCustomer.creditDebitCards.creditDebitCard.length>0){var cards=response.gatewayCustomer.creditDebitCards.creditDebitCard;count=cards.length}if(module==="GetBanks"&&response.gatewayCustomer&&response.gatewayCustomer.wallet&&response.gatewayCustomer.wallet.bankAccounts&&response.gatewayCustomer.wallet.bankAccounts.bankAccount.length>0){var banks=response.gatewayCustomer.wallet.bankAccounts.bankAccount;count=banks.length}return count}function getFundsOutOption(){var fundsOut=sessionStorage.getItem("wuAmplitudeSMO_fundsOut");if(fundsOut==="BA"){return fundsOut}if(sessionStorage.getItem("SelectedPayOutOption")==="WA"){return fundsOut="WA"}}function getReceiverBankDetails(request){var data={};if(request&&request.receivers&&request.receivers.receiver){var item=request.receivers.receiver.length>0?request.receivers.receiver[0]:undefined;if(item&&item.wallet&&item.wallet.bank_accounts&&item.wallet.bank_accounts.bank_account.length>0){var content=item.wallet.bank_accounts.bank_account[0];data["bank_name"]=content.bank_name?content.bank_name:null;data["bank_location"]=content.bank_location?content.bank_location:null;data["routing_number"]=content.routing_number?content.routing_number:null;data["bank_code"]=content.bank_code?content.bank_code:null;data["swift_code"]=content.swift_code?content.swift_code:null;data["sort_code"]=content.sort_code?content.sort_code:null;data["financial_id"]=content.financial_id?content.financial_id:null;data["branch_name"]=content.branch_name?content.branch_name:null;data["branch_code"]=content.branch_code?content.branch_code:null}}return data}function addReceiverAccountTypeForMexico(request){var summaryObjects=JSON.parse(sessionStorage.SummaryObjects);if(request.address.country_iso_code==="MX"&&summaryObjects.payout_method_code==="500"){var accountType=_.get(request,"wallet.bank_accounts.bank_account[0].account_type");if(accountType==="BANK"){return"account_number"}else if(accountType&&accountType.toLowerCase()==="debit"){return"debitcard"}else{return"clabe"}}else{return false}}function setFundsOutUpiAmplitudeData(request){var payoutType=_.get(request,"wallet.bankAccounts[0].account_selected_type").toLowerCase();return payoutType==="upi"?payoutType:false}function GetLoyaltyCardsCampaigns(response){var campaignIds="";if(response.gatewayCustomer&&response.gatewayCustomer.additionalPreferredCustomers&&response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer&&response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.promoCodes&&response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.promoCodes.promoCode){response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.promoCodes.promoCode.forEach((function(item){campaignIds=campaignIds+item.campaignId+","}))}return campaignIds}function getSMVSMO(module,request,response){var data={};data["resend"]="false";data["promo_applied"]=false;if(sessionStorage.getItem("isResendFlow")==="true"){data["resend"]="true";sessionStorage.setItem("wuAmplitude_resendMtcn","true");sessionStorage.setItem("isResendFlow","false")}if(sessionStorage.getItem("resendRetail")==="true"){data["resend"]="true";sessionStorage.setItem("wuAmplitude_resendMtcn","true");sessionStorage.setItem("resendRetail","false")}if(module==="SendMoneyStore"){if(sessionStorage.getItem("wuAmplitude_resendMtcn")==="true"){data["resend"]="true";sessionStorage.setItem("wuAmplitude_resendMtcn","false")}else{data["resend"]="false"}}if(wuSessionStorage&&wuSessionStorage.ValidationRequest&&JSON.parse(wuSessionStorage.ValidationRequest).payment_details&&JSON.parse(wuSessionStorage.ValidationRequest).payment_details.promotion&&JSON.parse(wuSessionStorage.ValidationRequest).payment_details.promotion.discount!=="0"){data["promo_applied"]=true}if(response&&response.authorizationStatus&&response.authorizationStatus.code){data["hold_code"]=response.authorizationStatus.code}if(module==="SendMoneyValidation"&&response&&response.payment_details&&response.payment_details.fee_threshold_flag&&response.payment_details.fx_threshold_flag){data["fee_threshold_flag"]=response.payment_details.fee_threshold_flag.toLowerCase();data["fx_threshold_flag"]=response.payment_details.fx_threshold_flag.toLowerCase()}if(module==="SendMoneyValidation"&&response&&response.payment_details&&response.payment_details.credit_debit_card&&response.payment_details.credit_debit_card.card_type){data["card_issuer"]=response.payment_details.credit_debit_card.card_type.toLowerCase();data["card_type"]=response.payment_details.credit_debit_card.card_type}if(module==="SendMoneyStore"&&response&&response.paymentDetails&&response.paymentDetails.creditDebitCard&&response.paymentDetails.creditDebitCard.cardType){data["card_issuer"]=response.paymentDetails.creditDebitCard.cardType.toLowerCase();data["card_type"]=response.paymentDetails.creditDebitCard.cardType}return data}function getNameChangeCancelTransferDetail(){if(wuSessionStorage&&wuSessionStorage.NameChangeOriginal_Obj){var NameChangeObj=JSON.parse(wuSessionStorage.NameChangeOriginal_Obj);var tatAmpliDetails=sessionStorage.getItem("tat_ampli_details")?JSON.parse(sessionStorage.getItem("tat_ampli_details")):null;var data={};if(NameChangeObj.transferAmount){data["send_amount"]=NameChangeObj.transferAmount}if(NameChangeObj.receiverGets){data["receive_amount"]=NameChangeObj.receiverGets}if(NameChangeObj.origCurrencyCode){data["send_currency"]=NameChangeObj.origCurrencyCode.toLowerCase()}if(NameChangeObj.destCurrencyCode){data["receive_currency"]=NameChangeObj.destCurrencyCode.toLowerCase()}if(NameChangeObj.payInMethod){data["funds_in"]=NameChangeObj.payInMethod}if(NameChangeObj.payOutMethod){data["funds_out"]=getFundsOutCode(NameChangeObj.payOutMethod)}if(NameChangeObj.exchangeRate){data["exchange_rate"]=NameChangeObj.exchangeRate}if(NameChangeObj.transferFee){data["transfer_fee"]=NameChangeObj.transferFee}if(NameChangeObj.originationCountry){data["sender_country"]=NameChangeObj.originationCountry.toLowerCase()}if(NameChangeObj.destinationCountry){data["receiver_country"]=NameChangeObj.destinationCountry.toLowerCase()}if(wuSessionStorage.cancel_reason_code){data["cancel_reason"]=wuSessionStorage.cancel_reason_code}if(tatAmpliDetails&&tatAmpliDetails.tat_entrypoint){data["tat_entrypoint"]=tatAmpliDetails.tat_entrypoint}if(NameChangeObj.customer_type){data["tat_flow"]=NameChangeObj.customer_type==="D"?"DIGITAL":"RETAIL"}return data}}function checkNameChangeCancelTransferFlow(){var nameChangeList=["txn-name-edit","namechangereview","namechangereceipt"];var cancelTransferList=["retailcancelcode","cancel-review","cancelreceipt"];if(nameChangeList.indexOf(wuSessionStorage.page_name)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false);sessionStorage.setItem("wuAmplitude_useNameChangeObj",true)}if(cancelTransferList.indexOf(wuSessionStorage.page_name)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false);sessionStorage.setItem("wuAmplitude_useCancelTransferObj",true)}}function mandatoryAttributes(){var commonAttr={};commonAttr.page_gatsby=true;if(getCookieValue("WUCountryCookie_")){if(getCookieValue("AKCountry")=="GI"&&getCookieValue("WUCountryCookie_")=="GB"){commonAttr.sender_country="gi"}else{commonAttr.sender_country=getCookieValue("WUCountryCookie_").toLowerCase()}}if(getCookieValue("SessionId")){commonAttr.session_id=getCookieValue("SessionId")}if(getCookieValue("wu_device_id")){commonAttr.device_id=getCookieValue("wu_device_id")}var userTypeIdentity=getCookieValue("userIdentity")?getCookieValue("userIdentity"):"newCustomer";if(userTypeIdentity){commonAttr.user_pricing_session=userTypeIdentity}commonAttr["wu_platform"]=getWuPlatform();commonAttr["wu_device_type"]=getWuDeviceType();commonAttr["page_name"]=oldPageName==="refer-friend"?"refer-a-friend":oldPageName;commonAttr["current_url"]=window.location.href;commonAttr["logged_in"]=isLoggedin(wuSessionStorage);commonAttr["user_path"]=sessionStorage.getItem("initiator")==="server"?"ssr":"ng6";if(sessionStorage&&sessionStorage.getItem("_wuAnalyticIVS")){commonAttr.identity_verification_status=sessionStorage.getItem("_wuAnalyticIVS");commonAttr.verification_source=sessionStorage.getItem("_wuAnalyticIVSource");sessionStorage.removeItem("_wuAnalyticIVS");sessionStorage.removeItem("_wuAnalyticIVSource");sessionStorage.setItem("wuAmplitude_idvstatus",commonAttr.identity_verification_status)}else if(wuSessionStorage&&wuSessionStorage.GatewayCustomer&&commonAttr["logged_in"]=="true"){var gatewayCustomer=JSON.parse(wuSessionStorage.GatewayCustomer);if(gatewayCustomer.identityVerificationStatus&&gatewayCustomer.identityVerificationStatus!==null&&gatewayCustomer.identityVerificationStatus!==undefined&&gatewayCustomer.identityVerificationStatus!==""){commonAttr.identity_verification_status=gatewayCustomer.identityVerificationStatus.toLowerCase()}sessionStorage.setItem("wuAmplitude_idvstatus",commonAttr.identity_verification_status)}if(commonAttr["logged_in"]=="true"&&sessionStorage.getItem("wuAmplitude_idvstatus")){commonAttr.identity_verification_status=sessionStorage.getItem("wuAmplitude_idvstatus")}commonAttr["app_version"]=sessionStorage.getItem("assetVersion")&&sessionStorage.getItem("assetVersion")!=="null"&&sessionStorage.getItem("assetVersion")!=="undefined"?sessionStorage.getItem("assetVersion"):"main0.js";var campaign_name=getURLParameter("campaign_name");if(campaign_name){sessionStorage.setItem("campaign_name",campaign_name)}if(sessionStorage.getItem("campaign_name")){commonAttr["campaign_name"]=sessionStorage.getItem("campaign_name")}if(sessionStorage.getItem("ab_test")){commonAttr["ab_test"]=sessionStorage.getItem("ab_test").toLowerCase()}if(sessionStorage.getItem("ab_test_variant")){commonAttr["ab_test_variant"]=sessionStorage.getItem("ab_test_variant").toLowerCase()}return commonAttr}function optionalAttributes(){var optionAttr={};if(wuSessionStorage&&wuSessionStorage.wuAmplitude_useSummaryObj!=="false"){if(wuSessionStorage.SummaryObjects&&wuSessionStorage.SummaryObjects!==null&&wuSessionStorage.SummaryObjects!=="null"){var summaryObjects=JSON.parse(wuSessionStorage.SummaryObjects);var senderInfo=getOptSender(summaryObjects);var receiverInfo=getOptReceiver(summaryObjects);var transactionInfo=getOptTransaction(summaryObjects);Object.assign(optionAttr,senderInfo,receiverInfo,transactionInfo)}else{if(wuSessionStorage.wuAmplitudeSMO_receiverCountry){optionAttr.receiver_country=wuSessionStorage.wuAmplitudeSMO_receiverCountry}if(wuSessionStorage.wuAmplitudeSMO_fundsOut){optionAttr.funds_out=getFundsOutCode(wuSessionStorage.wuAmplitudeSMO_fundsOut)}if(wuSessionStorage.wuAmplitudeSMO_fundsIn){optionAttr.funds_in=wuSessionStorage.wuAmplitudeSMO_fundsIn}}}else if(wuSessionStorage&&wuSessionStorage.wuAmplitude_useSummaryObj==="false"){if(wuSessionStorage.wuAmplitude_useNameChangeObj==="true"||wuSessionStorage.wuAmplitude_useCancelTransferObj==="true"){var nameChangeCancelTransferDetail=getNameChangeCancelTransferDetail();if(nameChangeCancelTransferDetail&&typeof nameChangeCancelTransferDetail==="object"){optionAttr=nameChangeCancelTransferDetail}}else{if(wuSessionStorage.wuAmplitudeSMO_receiverCountry){optionAttr.receiver_country=wuSessionStorage.wuAmplitudeSMO_receiverCountry}else{if(wuSessionStorage.SummaryObjects&&wuSessionStorage.SummaryObjects!==null&&wuSessionStorage.SummaryObjects!=="null"){var summaryObjects=JSON.parse(wuSessionStorage.SummaryObjects);var receiverInfo=getOptReceiver(summaryObjects);optionAttr.receiver_country=receiverInfo.receiver_country}}if(wuSessionStorage.wuAmplitudeSMO_fundsOut){optionAttr.funds_out=getFundsOutCode(wuSessionStorage.wuAmplitudeSMO_fundsOut)}if(wuSessionStorage.wuAmplitudeSMO_fundsIn){optionAttr.funds_in=wuSessionStorage.wuAmplitudeSMO_fundsIn}if(wuSessionStorage.wuAmplitudeSMO_fundsIn&&wuSessionStorage.wuAmplitudeSMO_fundsIn==="AG"&&wuSessionStorage.Efl){var eflObj=JSON.parse(wuSessionStorage.Efl);var eflState=eflObj.address&&eflObj.address.state;if(eflState){optionAttr.efl_state=eflState}}}}if(wuSessionStorage&&wuSessionStorage.SenderMEXObj&&wuSessionStorage.isDirectedCountry&&wuSessionStorage.isDirectedCountry=="Y"){var directedObject=JSON.parse(wuSessionStorage.SenderMEXObj);optionAttr.city=directedObject.mexCity}if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_sendReceiveLock){optionAttr.send_receive_lock=wuSessionStorage.wuAmplitudeSMO_sendReceiveLock}if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_providerid){optionAttr.provider_id=wuSessionStorage.wuAmplitudeSMO_providerid}if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_src){var wusource=wuSessionStorage.wuAmplitudeSMO_src;if(wusource.indexOf("fb_msngr")!==-1){optionAttr.wu_source="fb-bot"}else{optionAttr.wu_source=wusource}}var partnerName=getCookieValue("partnerName");if(partnerName){optionAttr.partner_name=partnerName.toLowerCase()}if(wuSessionStorage&&wuSessionStorage.userJourney){optionAttr.user_journey=wuSessionStorage.userJourney;if((wuSessionStorage.userJourney=="bill-pay"||wuSessionStorage.userJourney=="inmate-pay")&&_.has(summaryObjects,"feeInquiry.wuProduct.speedIndicator")){optionAttr.speed_of_delivery=summaryObjects.feeInquiry.wuProduct.speedIndicator}if(wuSessionStorage.userJourney=="receiver-redirect"){optionAttr.user_journey="receiver-directed"}}if(optionAttr&&!optionAttr.send_amount&&wuSessionStorage&&wuSessionStorage.wuAmplitude_sendAmount){optionAttr.send_amount=wuSessionStorage.wuAmplitude_sendAmount}if(wuSessionStorage&&wuSessionStorage.SendMoneyObjects||wuSessionStorage.CustomerVerificationStatus){if(wuSessionStorage.SendMoneyObjects){var sendMoneyObjects=JSON.parse(wuSessionStorage.SendMoneyObjects);var kyc_duc=_.get(sendMoneyObjects,"sender.kycDetails.duc.ducDelivery.available");var kyc_ducDocs=_.get(sendMoneyObjects,"sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument[0].type");var kyc_dur=_.get(sendMoneyObjects,"sender.kycDetails.dur.durDelivery");var kyc_durDocs=_.get(sendMoneyObjects,"sender.kycDetails.dur.durDelivery.durDocTypes")}else{var customerVerificationStatus=JSON.parse(wuSessionStorage.CustomerVerificationStatus);var kyc_duc=_.get(customerVerificationStatus,"sender.kyc_details.duc.ducDelivery.available");var kyc_ducDocs=_.get(customerVerificationStatus,"sender.kyc_details.duc.ducDelivery.ducDocuments.ducDocument[0].type");var kyc_dur=_.get(customerVerificationStatus,"sender.kyc_details.dur.durDelivery");var kyc_durDocs=_.get(customerVerificationStatus,"sender.kyc_details.dur.durDelivery.durDocTypes")}if(kyc_duc){if(wuSessionStorage.paSubType)optionAttr.paSubType=wuSessionStorage.paSubType}}if(wuSessionStorage&&wuSessionStorage.formId){optionAttr.form_id=wuSessionStorage.formId}return optionAttr}function getOptSender(summaryObjects){var sender={};if(isLoggedin()){if(wuSessionStorage&&wuSessionStorage.AccountNumber){var encCustAccNum=md5Encryption(wuSessionStorage.AccountNumber);sender.sender_account_number=encCustAccNum}}sender.send_amount=summaryObjects.transfer_amount;if(summaryObjects.defaultCurrencyIsoCode){sender.send_currency=summaryObjects.defaultCurrencyIsoCode.toLowerCase()}return sender}function getOptReceiver(summaryObjects){var receiver={};if(summaryObjects.uid){receiver.receiver_account_number=md5Encryption(summaryObjects.uid)}if(summaryObjects.flag_position){receiver.receiver_country=summaryObjects.flag_position.toLowerCase()}else if(summaryObjects&&summaryObjects.feeInquiryData&&summaryObjects.feeInquiryData.destnCountry&&summaryObjects.feeInquiryData.destnCountry.isoCode){var receiverCountryCode=summaryObjects.feeInquiryData.destnCountry.isoCode.toLowerCase();sessionStorage.setItem("wuAmplitudeSMO_receiverCountry",receiverCountryCode);receiver.receiver_country=receiverCountryCode}else if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_receiverCountry){receiver.receiver_country=wuSessionStorage.wuAmplitudeSMO_receiverCountry}if(summaryObjects.currencyIsoCode){receiver.receive_currency=summaryObjects.currencyIsoCode.toLowerCase()}if(summaryObjects.sourceOfFundsText&&summaryObjects.purposeText&&wuSessionStorage.page_name=="receiver"){receiver.reciver_source_of_funds=summaryObjects.sourceOfFundsText;receiver.reciver_purpose_of_transaction=summaryObjects.purposeText}receiver.receive_amount=summaryObjects.receiver_currency;if(summaryObjects.walletObj&&summaryObjects.walletObj.service_provider_name){receiver.wallet_service_provider=summaryObjects.walletObj.service_provider_name}return receiver}function getOptTransaction(summaryObjects){var transaction={};transaction.exchange_rate=summaryObjects.exchangeRate;if(summaryObjects.paying_method){transaction.funds_in=summaryObjects.paying_method.toLowerCase()}else if(summaryObjects&&summaryObjects.feeInquiryData&&summaryObjects.feeInquiryData.destnCountry&&summaryObjects.feeInquiryData.destnCountry.selectedPayinName){transaction.funds_in=summaryObjects.feeInquiryData.destnCountry.selectedPayinName.toLowerCase()}else if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_fundsIn){transaction.funds_in=wuSessionStorage.wuAmplitudeSMO_fundsIn.toLowerCase()}transaction.funds_out=getFundsOut(summaryObjects);if(transaction.funds_out==="cash"){transaction.agent_network="all"}transaction.transfer_fee=summaryObjects.transfer_fee;if(summaryObjects.type&&summaryObjects.type!=="sending_money"){if(summaryObjects.payout_method_code){transaction.biller=summaryObjects.payout_method_code.toLowerCase()}else if(wuSessionStorage.wuAmplitude_biller){transaction.biller=wuSessionStorage.wuAmplitude_biller.toLowerCase()}}return transaction}function getFundsOut(summaryObjects){var funds_out=null;if(summaryObjects.type&&summaryObjects.type!=="sending_money"){if(summaryObjects.type==="reload-options"){funds_out="mobile-reload"}else if(summaryObjects.type==="bill-pay"||summaryObjects.type==="inmate-pay"){funds_out=summaryObjects.type==="bill-pay"?"billpay":"inmatepay"}else{funds_out=summaryObjects.type}}else{if(summaryObjects.payout_method_code){funds_out=getFundsOutCode(summaryObjects.payout_method_code)}else if(summaryObjects&&summaryObjects.feeInquiryData&&summaryObjects.feeInquiryData.destnCountry&&summaryObjects.feeInquiryData.destnCountry.selectedPayoutName){funds_out=getFundsOutCode(summaryObjects.feeInquiryData.destnCountry.selectedPayoutName)}else if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_fundsOut){funds_out=getFundsOutCode(wuSessionStorage.wuAmplitudeSMO_fundsOut)}}return funds_out}function getFundsOutCode(fundsOutCode){var fundsOut=fundsOutCode;var data=[{code:"500",value:"d2b"},{code:"000",value:"cash"},{code:"600",value:"MMT"},{code:"BA",value:"d2b"},{code:"AG",value:"cash"},{code:"WA",value:"wa"},{code:"200",value:"d2c"},{code:"800",value:"wa"}];for(var i=0;i<data.length;i++){if(fundsOut===data[i].code){return data[i].value}}return fundsOut}function getCookieValue(cookieName){var i,key,value,cookiesArray=document.cookie.split(";");for(i=0;i<cookiesArray.length;i++){key=cookiesArray[i].substr(0,cookiesArray[i].indexOf("="));value=cookiesArray[i].substr(cookiesArray[i].indexOf("=")+1);key=key.replace(/^\s+|\s+$/g,"");if(key===cookieName&&value!==""){return decodeURIComponent(value)}}}function getCurrentPageNameURL(){if(window.location.href){var url=location.protocol+"//"+location.host+location.pathname;let rodeoCookie=getCookieValue("homePageExperience");if(url.indexOf("/blog/")!==-1){const blogPageName=document.getElementById("pageAmplitudeId");return blogPageName?.value?"blog_"+blogPageName.value:"blog"}else if(rodeoCookie&&rodeoCookie=="rodeo"&&url.indexOf("/home.html")!==-1){return"home_rodeo"}else if(rodeoCookie&&rodeoCookie=="rodeo"&&url.indexOf("/send-money")!==-1){return"home_countryselected_rodeo"}else if(url.endsWith("/rewards/home.html")){return"rewards-home"}else if(url.indexOf("/home.html")!==-1){url=url.substring(0,url.indexOf(".html"));var currentPageNameURL=url.split("/").slice(-1)[0];return currentPageNameURL}else if(url.indexOf("/currency-converter")!==-1){return"currency-converter"}else if(url.indexOf("/gcr")!==-1){return"gcr"}else if(url.endsWith("/mrbeast.html")){return"mrbeast"}else if(url.endsWith("/mrbeast/receiver.html")){return"mrbeast_receiver"}else if(url.endsWith("/mrbeast/success.html")){return"mrbeast_success"}else if(url.endsWith("/rewards/dashboard.html")){return"rewards-dashboard"}else if(url.endsWith("/rewards/shop-deals.html")){return"rewards-deals"}else if(url.endsWith("/rewards/merchant-details.html")){return"rewards-merchant-details"}else if(url.indexOf("/rewards/merchant-details.html")!==-1){return"rewards-merchant-details"}else if(url.endsWith("/rewards/top-merchants.html")){return"rewards-top-merchants"}else if(url.endsWith("/rewards/receiver.html")){return"rewards-receiver"}else if(url.indexOf("/global")!==-1&&url.endsWith("/fraud-awareness.html")){return"fraud-awareness"}else if(url.indexOf("/global")!==-1&&url.endsWith("/fraud-resources.html")){return"fraud-resources"}else if(url.endsWith("/rmo-form.html")){return"rmo-refunds-customer-info"}else if(url.indexOf("/global")!==-1&&url.endsWith("/full-registration.html")){return"receiver-registration"}else if(url.indexOf("/global")!==-1&&url.endsWith("/send-otp.html")){return"send-otp"}else if(url.indexOf("/global")!==-1&&url.endsWith("/verify-otp.html")){return"verify-otp"}else if(url.indexOf("/global")!==-1&&url.endsWith("/add-bank.html")){return"add-bank"}else if(url.indexOf(".html")!==-1){url=url.substring(0,url.indexOf(".html"));var currentPageNameURL="non-transactional";return currentPageNameURL}}}function md5Encryption(plainStr){var encNum=null;if(plainStr&&typeof md5!=="undefined"){encNum=md5(plainStr)}return encNum}function isLoggedin(wuSessionStorage){var loginState=null;if(wuSessionStorage&&wuSessionStorage.getItem("AccountNumber")||getCookieValue("AccountNumber")){loginState="true"}else{loginState="false"}return loginState}function getAmpURLParam(name){var urlParams=location.search||location.hash;if(urlParams&&urlParams.toLowerCase()){var urlParams=urlParams.toLowerCase();var returnValue=decodeURIComponent((new RegExp("[?|&]"+name+"="+"([^&;]+?)(&|#|;|$)").exec(urlParams)||[,""])[1].replace(/\+/g,"%20"))||null;if(returnValue!==undefined&&returnValue!==null){returnValue=returnValue.trim()}return returnValue}}function getProviderId(){var provider_id=getAmpURLParam("providerid");if(provider_id){sessionStorage.setItem("wuAmplitudeSMO_providerid",provider_id)}}function getWuSource(){var wu_source=getAmpURLParam("src");if(wu_source){sessionStorage.setItem("wuAmplitudeSMO_src",wu_source)}}function getPartnerName(){var wu_partner=getAmpURLParam("partnerName")?getAmpURLParam("partnerName"):getCookieValue("partnerName");if(wu_partner){sessionStorage.setItem("wuAmplitudeSMO_partnerName",wu_partner)}}function getTodayDate(){function pad(number){if(number<10){return"0"+number}return number}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+pad(this.getUTCMonth()+1)+"-"+pad(this.getUTCDate())+"T"+pad(this.getUTCHours())+":"+pad(this.getUTCMinutes())+":"+pad(this.getUTCSeconds())};var today=new Date;return today.toISOString()}function isInAppWebView(){const userAgent=window.navigator.userAgent;const isWUMobileAppWebView=/(wv|WebView)/i.test(userAgent);return isWUMobileAppWebView}function getWuDeviceType(){const userAgent=window.navigator.userAgent;var getAppOS=null;if(isInAppWebView()){getAppOS="webview"}else if(userAgent.includes("Android")){getAppOS="android"}else if(navigator.userAgent.includes("iPhone")){getAppOS="ios"}else{getAppOS="desktop"}return getAppOS}function getWuPlatform(){return window.location.href?"r3_responsive_web":null}function setRegisterFlag(response){var status=_.get(response,"gatewayCustomer.registrationStatus")==="P"?"P":"F";var identify=(new amplitude.Identify).setOnce("register_flag",status);amplitude.getInstance().identify(identify)}function checkCurrentPageName(currentPageName){if(currentPageName=="kycoption-duc"&&wuSessionStorage&&wuSessionStorage.ducPageName){currentPageName=wuSessionStorage.ducPageName}return currentPageName}function toTitleCase(str){return str.replace(/\w\S*/g,(function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()}))}function sendAnalyticsData(apiEventAttr,Request,Response,module){try{var senderCountry="";if(getCookieValue("WUCountryCookie_")){senderCountry=getCookieValue("WUCountryCookie_").toLowerCase()}if(datahub_config.amplitude&&window.amplitude){if(module){if(localStorage.getItem("amplitudeRegisterCustomer")!==null&&localStorage.getItem("amplitudeRegisterCustomer")!==""){var localCustomerRequest=JSON.parse(localStorage.getItem("amplitudeRegisterCustomer"));if(localCustomerRequest&&localCustomerRequest.gateway_customer&&localCustomerRequest.gateway_customer.identities){delete localCustomerRequest.gateway_customer.identities;var localRegRequest=JSON.stringify(localCustomerRequest);localStorage.setItem("amplitudeRegisterCustomer",localRegRequest)}}var ignoreList=["AddRewardsToCustomerWallet","AuthenticateCustomer","AvailableKYCOptions","GetPaymentInstruments","Languages","PayoutCommit","PromoAPI","RetailCustomerLookUp","SendMobileAppMail","VerifyPhone"];var api_event=Request&&Request["isRetail"]?"api_Retail"+module:"api_"+module;if(module==="RegisterCustomer"){if(_.has(Request,"gateway_customer.address.raw_address")){apiEventAttr["suggested_address"]=true}if(Response.gatewayCustomer){if(Response.gatewayCustomer&&Response.gatewayCustomer.preferredCustomer&&Response.gatewayCustomer.preferredCustomer.accountNbr){var userId=md5Encryption(Response.gatewayCustomer.preferredCustomer.accountNbr);if(userId!==null){setUserId(userId);setRegisterCustomerIdentify(Request)}}}else if(apiEventAttr.api_response_code==="C6006"){if(Request&&Request.gateway_customer&&Request.gateway_customer.identities){delete Request.gateway_customer.identities}var localRequest=JSON.stringify(Request);localStorage.setItem("amplitudeRegisterCustomer",localRequest)}}if(module==="SendMoneyStore"){if(Request.wu_product&&Request.wu_product.is_directed=="Y"){apiEventAttr["is-directed"]="Yes";apiEventAttr["directed-agent"]=Request.wu_product.location}if(!Response.error||Response.error.code==="C1146"){setSMSIdentify(apiEventAttr,Response)}}if(module==="SendMoneyValidation"||module==="SendMoneyStore"){_.get(Request,"sender.subscription_id")?apiEventAttr["subscription_id"]=_.get(Request,"sender.subscription_id"):null;var gatewayCustomer=JSON.parse(sessionStorage.getItem("GatewayCustomer"));setRegisterFlag(gatewayCustomer)}if(module==="GetLoyaltyCards"){if(!Response.error){setGLCIdentify(Response)}}if(module==="GetCustomerProfile"){if(Response&&Response.gatewayCustomer&&Response.gatewayCustomer.identityVerificationStatus){apiEventAttr.identity_verification_status=Response.gatewayCustomer.identityVerificationStatus.toLowerCase()}setRegisterFlag(Response)}if(module==="CustomerSignOn"){var signOnNumber=apiEventAttr.customerSignOnAccountNumber;customerId=apiEventAttr.customerSignOnAccountNumber;delete apiEventAttr.customerSignOnAccountNumber;var encCustAccNum=md5Encryption(signOnNumber);if(encCustAccNum!==null){setUserId(encCustAccNum);if(localStorage.getItem("amplitudeRegisterCustomer")!==null){var request=JSON.parse(localStorage.getItem("amplitudeRegisterCustomer"));setRegisterCustomerIdentify(request);localStorage.removeItem("amplitudeRegisterCustomer")}}apiEventAttr.sender_account_number=encCustAccNum}if(apiEventAttr.device_id){amplitude.getInstance().setDeviceId(apiEventAttr.device_id)}if(module==="GetReceivers"){if(Response&&!Response.error){var receiverCount=0;if(Response.receivers&&Response.receivers.receiver){var receiverCount=Response.receivers.receiver.length}var identify=(new amplitude.Identify).set("receivers_count",receiverCount);amplitude.getInstance().identify(identify)}}if(module==="VerifyEID"&&Response&&!Response.error){var verifyEidRes="N";if(Response.verification_status){verifyEidRes=Response.verification_status}apiEventAttr.identity_verification_status=verifyEidRes;if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName&&wuSessionStorage.wuAmplitude_pageName==="ev-profile-confirmation"&&Response.verification_status&&Response.verificationSource&&Response.nameMatched&&Response.dobMatched){apiEventAttr["verification_source"]=Response.verificationSource;apiEventAttr["name_match_status"]=Response.nameMatched;apiEventAttr["dob_match_status"]=Response.dobMatched;sessionStorage.setItem("_wuAnalyticIVS",Response.verification_status);sessionStorage.setItem("_wuAnalyticIVSource",Response.verificationSource)}}if(module==="InitiateCustomerVerification"&&Response&&!Response.error){if(Response.identityVerificationStatus){apiEventAttr.identity_verification_status=Response.identityVerificationStatus.toLowerCase()}}if(module=="UpdateCustomerProfile"){var isMarketingEnabled=isFeatureEnabled("MARKETING_ON_PR",senderCountry.toUpperCase());var isImplicitCountry=isFeatureEnabled("IMPLICIT_MARKETING_ON_PR",senderCountry.toUpperCase());if(_.has(Request,"gateway_customer.address.raw_address")){apiEventAttr["suggested_address"]=true}var isZipCodeService=wuSessionStorage.isZipCodeService?JSON.parse(wuSessionStorage.isZipCodeService):null;var gatewayCustomer=JSON.parse(wuSessionStorage.GatewayCustomer);if(getCookieValue("WUCountryCookie_")=="BR"&&(isZipCodeService||_.get(gatewayCustomer,"address.advvStatus")==="Y")){apiEventAttr["address_verification_status"]=true;delete wuSessionStorage.isZipCodeService}if(apiEventAttr.page_name==="completeyourprofile"&&_.get(Request,"gateway_customer.gender")){var identify=(new amplitude.Identify).setOnce("gender",_.get(Request,"gateway_customer.gender"));amplitude.getInstance().identify(identify)}if(isMarketingEnabled||isImplicitCountry){apiEventAttr["marketing_consent"]=false;apiEventAttr["mywu_consent"]=false;if(_.get(Request,"gateway_customer.account_preferences.email")){apiEventAttr["marketing_consent"]=true}else if(_.get(Request,"gateway_customer.account_preferences.message")){apiEventAttr["marketing_consent"]=true}else if(_.get(Request,"gateway_customer.account_preferences.direct_mail")){apiEventAttr["marketing_consent"]=true}else if(_.get(Request,"gateway_customer.account_preferences.telephone_call")){apiEventAttr["marketing_consent"]=true}if(_.get(Response,"gatewayCustomer.termsConditionFlag")==="1"){apiEventAttr["mywu_consent"]=true}}if(_.has(Request,"gateway_customer.account_preferences.thirdparty_datasharing_consent")){apiEventAttr["3rd_party_data_sharing"]=_.get(Request,"gateway_customer.account_preferences.thirdparty_datasharing_consent")}}if(module=="oauth/authenticate"&&Request&&Response){setAuthenticateCustomerInfo(Request,Response)}if((module==="catalog"||module==="estimate"||module==="qqcCatalog"||module==="reload")&&Request){_.get(Request,"sender.send_amount")?apiEventAttr["send_amount"]=_.get(Request,"sender.send_amount"):null;_.get(Request,"sender.curr_iso3")?apiEventAttr["send_currency"]=_.get(Request,"sender.curr_iso3").toLowerCase():null;_.get(Request,"receiver.receive_amount")?apiEventAttr["receive_amount"]=_.get(Request,"receiver.receive_amount"):null;_.get(Request,"receiver.curr_iso3")?apiEventAttr["receive_currency"]=_.get(Request,"receiver.curr_iso3").toLowerCase():null;_.get(Request,"receiver.company_code")?apiEventAttr["biller"]=_.get(Request,"receiver.company_code").toLowerCase():null;_.get(Response,"receiver.company_code")&&module==="reload"?apiEventAttr["biller"]=_.get(Response,"receiver.company_code").toLowerCase():null;if(_.get(Response,"response_status.status")===-1){apiEventAttr["api_response_code"]=_.get(Response,"response_status.code");apiEventAttr["api_response_message"]=_.get(Response,"response_status.message")}_.get(Request,"campaign.campaign_name")?apiEventAttr["pricing_campaign"]=_.get(Request,"campaign.campaign_name"):null;_.get(Request,"campaign.subscription_id")?apiEventAttr["subscription_id"]=_.get(Request,"campaign.subscription_id"):null;_.get(Response,"sender.segment")?apiEventAttr["pricing_segment"]=_.get(Response,"sender.segment"):null;getCookieValue("promoCampaignSubscriptionEndDate")&&module==="catalog"?apiEventAttr["subscription_expiry_date"]=getCookieValue("promoCampaignSubscriptionEndDate"):null}if(module==="PromoAPI"&&Request){_.get(Request,"get_promo_dsc.money_txn.orig_cty_iso2_ext")?apiEventAttr["sender_country"]=_.get(Request,"get_promo_dsc.money_txn.orig_cty_iso2_ext"):null;_.get(Request,"get_promo_dsc.money_txn.dest_cty_iso2_ext")?apiEventAttr["receiver_country"]=_.get(Request,"get_promo_dsc.money_txn.dest_cty_iso2_ext"):null;_.get(Request,"get_promo_dsc.money_txn.send_amount")?apiEventAttr["send_amount"]=_.get(Request,"get_promo_dsc.money_txn.send_amount"):null;_.get(Request,"get_promo_dsc.money_txn.orig_curr_iso3")?apiEventAttr["send_currency"]=_.get(Request,"get_promo_dsc.money_txn.orig_curr_iso3").toLowerCase():null;_.get(Request,"get_promo_dsc.money_txn.dest_curr_iso3")?apiEventAttr["receive_currency"]=_.get(Request,"get_promo_dsc.money_txn.dest_curr_iso3").toLowerCase():null;if(_.get(Response,"status.error.code")){apiEventAttr["api_response_code"]=_.get(Response,"status.error.code");apiEventAttr["api_response_message"]=_.get(Response,"status.error.message")}}if(module=="TransactionInquiry"&&Request&&Response){if(_.get(Response,"statusDetails.transactionIdentifier")){apiEventAttr["user_type"]=_.get(Response,"statusDetails.transactionIdentifier").toLowerCase()}if(_.get(Response,"statusDetails.statusLabel")&&_.get(Response,"transactionStatus")){apiEventAttr["mtcn_status"]=_.get(Response,"statusDetails.statusLabel")+" - "+_.get(Response,"transactionStatus")}else{apiEventAttr["mtcn_status"]=_.get(Response,"transactionStatus")?_.get(Response,"transactionStatus"):_.get(Response,"statusDetails.statusLabel")}}updateWULanguage();setUtmSrcParameter(apiEventAttr);setReferrerParameter(apiEventAttr);if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){apiEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",api_event);var isPostLoginPromoEnabled=isFeatureEnabled("POST_LOGIN_PROMO_CAMPAIGN",senderCountry);if(module==="SendMoneyValidation"&&isPostLoginPromoEnabled){if(Request){customerId=_.get(Request,"sender.preferred_customer.account_nbr")?_.get(Request,"sender.preferred_customer.account_nbr"):undefined;apiEventAttr["event_name"]="Send money validation attempted";apiEventAttr["campaign_name"]=_.get(Request,"sender.campaign_name")?_.get(Request,"sender.campaign_name"):null;apiEventAttr["subscription_id"]=_.get(Request,"sender.subscription_id")?_.get(Request,"sender.subscription_id"):null;hadoopAnalyticsLogsEvents(api_event,apiEventAttr)}if(Response&&!_.get(Response,"error")){apiEventAttr["event_name"]="Send money validation completed";apiEventAttr["campaign_name"]=_.get(Response,"sender.campaign_name")?_.get(Response,"sender.campaign_name"):null;apiEventAttr["subscription_id"]=_.get(Response,"sender.subscription_id")?_.get(Response,"sender.subscription_id"):null;apiEventAttr["subscription_expiry_date"]=_.get(Response,"sender.end_date")?new Date(_.get(Response,"sender.end_date")).getTime():null;hadoopAnalyticsLogsEvents(api_event,apiEventAttr)}}var parseDate=_.get(apiEventAttr,"subscription_expiry_date")?new Date(_.get(apiEventAttr,"subscription_expiry_date")):null;if(parseDate&&parseDate.toISOString()!==_.get(apiEventAttr,"subscription_expiry_date")){apiEventAttr["subscription_expiry_date"]=new Date(_.get(apiEventAttr,"subscription_expiry_date")).toISOString()}if(ignoreList.indexOf(module)===-1){logEvents(api_event,apiEventAttr)}}}}catch(err){console.error(err)}}function getSendReceiveLock(request){if(request.payment_details&&request.payment_details.destination&&request.payment_details.destination.expected_payout_amount){sessionStorage.setItem("wuAmplitudeSMO_sendReceiveLock","receive_locked")}else if(request.payment_details&&request.payment_details.origination&&request.payment_details.origination.principal_amount){sessionStorage.setItem("wuAmplitudeSMO_sendReceiveLock","send_locked")}}function getSMOReceiverCountry(request){if(wuSessionStorage&&wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.isoCode){var receiverCountryCode=JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.isoCode.toLowerCase();sessionStorage.setItem("wuAmplitudeSMO_receiverCountry",receiverCountryCode);if(receiverCountryCode!==oldCountryCode){var eventName="clicked_[send-money-option]_[dropdown-receiver-country]";oldCountryCode=receiverCountryCode;logSMOHackClickEvent(eventName)}}else if(wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).type&&JSON.parse(wuSessionStorage.SummaryObjects).type!=="sending_money"){if(request.serviceOptions&&request.serviceOptions.serviceOption&&request.serviceOptions.serviceOption.WEB&&request.serviceOptions.serviceOption.WEB.AG&&request.serviceOptions.serviceOption.WEB.AG.length>0){var data=request.serviceOptions.serviceOption.WEB.AG[0];if(data.paymentDetails&&data.paymentDetails.destination&&data.paymentDetails.destination.countryIsoCode){var receiverCountryCode=data.paymentDetails.destination.countryIsoCode.toLowerCase();sessionStorage.setItem("wuAmplitudeSMO_receiverCountry",receiverCountryCode)}}}}function getSMOFundsOut(){if(wuSessionStorage&&wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayoutName){var fundsOut=JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayoutName;sessionStorage.setItem("wuAmplitudeSMO_fundsOut",fundsOut);if(fundsOut!==oldFundsOut){var eventName="clicked_[send-money-option]_[tile-fundsout-"+fundsOut.toLowerCase()+"]";oldFundsOut=fundsOut;logSMOHackClickEvent(eventName)}}}function getSMOFundsIn(){if(wuSessionStorage&&wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayinName){var fundsIn=JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayinName.toLowerCase();sessionStorage.setItem("wuAmplitudeSMO_fundsIn",fundsIn);if(fundsIn!==oldFundsIn){var eventName="clicked_[send-money-option]_[tile-fundsin-"+fundsIn.toLowerCase()+"]";oldFundsIn=fundsIn;logSMOHackClickEvent(eventName)}}}function logSMOHackClickEvent(eventName){var currentPageName="";if(wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}if(window.amplitude&&datahub_config.amplitude){sessionStorage.setItem("wuAmplitude_useSummaryObj",false);var clickEventAttr=getAnalyticsData();sessionStorage.removeItem("wuAmplitude_useSummaryObj");if(currentPageName==="send-money-option"){var click_event=eventName;clickEventAttr.page_name=currentPageName;updateWULanguage();if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){clickEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",click_event);logEvents(click_event,clickEventAttr)}}}function modSMOTile(tileName,storageName){var tileMethod=tileName.split("-").pop();if(tileName.indexOf("-fundsOut-")!==-1){oldFundsOut=tileMethod}if(tileName.indexOf("-fundsIn-")!==-1){oldFundsIn=tileMethod}sessionStorage.setItem(storageName,tileMethod)}function getBiller(request){if(request.biller&&request.biller.code){sessionStorage.setItem("wuAmplitude_biller",request.biller.code)}}function getRegisterFlag(apiRequest){return apiRequest.progressive_registration==="true"?"P":"F"}function getSendAmount(request){if(request.payment_details&&request.payment_details.origination&&request.payment_details.origination.principal_amount){var sendAmount=request.payment_details.origination.principal_amount;sessionStorage.setItem("wuAmplitude_sendAmount",sendAmount)}}function setRegisterCustomerIdentify(apiRequest){var identify=(new amplitude.Identify).setOnce("wu_country",getCountry(apiRequest)).setOnce("wu_language",getCookieValue("WULanguageCookie_")?getCookieValue("WULanguageCookie_"):null).setOnce("registration_date",getTodayDate()).setOnce("age",getAge(apiRequest)).setOnce("gender",getGender(apiRequest)).setOnce("nationality",getNationality(apiRequest)).setOnce("lifetime_trxn_count",0).setOnce("lifetime_amount_sent",0).setOnce("lifetime_fee_paid",0).setOnce("mywu_points",0).setOnce("register_flag",getRegisterFlag(apiRequest));amplitude.getInstance().identify(identify)}function getCountry(apiRequest){var country="wu_country is not available";if(apiRequest.gateway_customer&&apiRequest.gateway_customer.address&&apiRequest.gateway_customer.address.country_iso_code){country=apiRequest.gateway_customer.address.country_iso_code}return country}function getAge(apiRequest){var age="age is not available";if(apiRequest.gateway_customer&&apiRequest.gateway_customer.date_of_birth){var profileBirth=apiRequest.gateway_customer.date_of_birth.split("-");var today_date=new Date;var today_year=today_date.getFullYear();var today_month=today_date.getMonth();var today_day=today_date.getDate();var birth_year=profileBirth[0];var birth_month=profileBirth[1];var birth_day=profileBirth[2];age=today_year-birth_year;if(today_month<birth_month-1){age--}if(birth_month-1==today_month&&today_day<birth_day){age--}}return age}function getGender(apiRequest){var gender=null;if(apiRequest.gateway_customer&&apiRequest.gateway_customer.gender){gender=apiRequest.gateway_customer.gender}return gender}function getNationality(apiRequest){var nationality=null;if(apiRequest.gateway_customer&&apiRequest.gateway_customer.nationality){nationality=apiRequest.gateway_customer.nationality}return nationality}function setSMSIdentify(apiResponse,Response){if(apiResponse.send_amount){var identify=(new amplitude.Identify).add("lifetime_trxn_count",1).add("lifetime_amount_sent",apiResponse.send_amount);amplitude.getInstance().identify(identify)}if(apiResponse.transfer_fee){var identify=(new amplitude.Identify).add("lifetime_fee_paid",apiResponse.transfer_fee);amplitude.getInstance().identify(identify)}if(Response.sender&&Response.sender.preferredCustomer&&Response.sender.preferredCustomer.totalPointsEarned){var identify=(new amplitude.Identify).set("mywu_points",Response.sender.preferredCustomer.totalPointsEarned);amplitude.getInstance().identify(identify)}}function setGLCIdentify(Response){if(Response.gatewayCustomer&&Response.gatewayCustomer.additionalPreferredCustomers&&Response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer&&Response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.totalPointsEarned){var identify=(new amplitude.Identify).set("mywu_points",Response.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.totalPointsEarned);amplitude.getInstance().identify(identify)}}function getURLParameter(name){var urlParams=location.search||location.hash;var returnValue=decodeURIComponent((new RegExp("[?|&]"+name+"="+"([^&;]+?)(&|#|;|$)").exec(urlParams)||[,""])[1].replace(/\+/g,"%20"))||null;if(returnValue!==undefined&&returnValue!==null){returnValue=returnValue.trim()}return returnValue}function getAmpGetQueryParams(qs){var qs=eval("qs");qs=qs.split("+").join(" ");var params={};var tokens;var re=/\butm_([^=]+)=([^&]+)/g;while(tokens=re.exec(qs)){params[decodeURIComponent(tokens[1])]=decodeURIComponent(tokens[2])}return params}function getAmplitudeReferrer(){var referralDomain=document.referrer;var referralEventPropertiesToReport={};var referralUserPropertiesToReport={};if(referralDomain){var hostname=new URL(String(referralDomain));referralEventPropertiesToReport["referrer"]=referralDomain;referralEventPropertiesToReport["referring_domain"]=hostname.hostname;referralUserPropertiesToReport["last_referrer"]=referralDomain;referralUserPropertiesToReport["last_referring_domain"]=hostname.hostname;window.amplitude&&window.amplitude.setUserProperties(referralUserPropertiesToReport);return referralEventPropertiesToReport}}function getAmplitudeUTMParameterCapture(){var propertiesToReport={};var userPropertiesToReport={};var ampUTMSessionObj=sessionStorage.getItem("ampUTMParam");var ampUserUTMSessionObj=sessionStorage.getItem("ampUserUTMParam");var utmSourcePropertiesToReport={};var srcCategory;var srcProperty=getURLParameter("src");var utmSrcListObj=sessionStorage.getItem("UTMSourcesList");var referralDomain=document.referrer;if(ampUTMSessionObj!==null){propertiesToReport=JSON.parse(ampUTMSessionObj);userPropertiesToReport=JSON.parse(ampUserUTMSessionObj)}else{var utmParams=getAmpGetQueryParams(document.location.search);if(srcProperty===undefined&&Object.keys(utmParams).length===0&&!referralDomain){propertiesToReport["utm_source"]="web-bookmark-or-typed";propertiesToReport["utm_medium"]="e-web-bookmark-or-typed";propertiesToReport["utm_campaign"]="organic-web-bookmark-or-typed";userPropertiesToReport["last_utm_source"]="web-bookmark-or-typed";userPropertiesToReport["last_utm_medium"]="e-web-bookmark-or-typed";userPropertiesToReport["last_utm_campaign"]="organic-web-bookmark-or-typed"}else if(!referralDomain){propertiesToReport["utm_source"]="web-bookmark-or-typed";propertiesToReport["utm_medium"]="e-web-bookmark-or-typed";propertiesToReport["utm_campaign"]="organic-web-bookmark-or-typed";userPropertiesToReport["last_utm_source"]="web-bookmark-or-typed";userPropertiesToReport["last_utm_medium"]="e-web-bookmark-or-typed";userPropertiesToReport["last_utm_campaign"]="organic-web-bookmark-or-typed"}else if(utmParams.hasOwnProperty("source")&&utmParams.hasOwnProperty("medium")&&utmParams.hasOwnProperty("campaign")){for(var param in utmParams){propertiesToReport["utm_"+param]=utmParams[param];userPropertiesToReport["last_utm_"+param]=utmParams[param]}}else if(srcProperty){if(utmSrcListObj!==null&&referralDomain){utmSrcListObj=utmSrcListObj.replace(/'/g,'"');utmSourcePropertiesToReport=JSON.parse(utmSrcListObj);var siteURLProp=new URL(referralDomain);var siteName=siteURLProp.hostname.split(".");siteName=siteName[1];Object.keys(utmSourcePropertiesToReport).forEach((function(key){if(utmSourcePropertiesToReport[key]){var category=utmSourcePropertiesToReport[key].split(",");for(var i=0;i<category.length;i++){if(key==="SOCIALSITES"||key==="SEARCHENGINES"){if(category[i]===siteName){srcCategory=key;break}}else{if(category[i]===srcProperty){srcCategory=key;break}}}}}));var properties=setUTMSrcParameters(srcCategory,siteName,srcProperty);propertiesToReport=properties[0];userPropertiesToReport=properties[1]}}else{var Attributes=getUTMForNonPaidTarffic();if(Attributes){propertiesToReport=Attributes[0];userPropertiesToReport=Attributes[1]}}if(Object.getOwnPropertyNames(propertiesToReport).length!==0){sessionStorage.setItem("ampUTMParam",JSON.stringify(propertiesToReport));sessionStorage.setItem("ampUserUTMParam",JSON.stringify(userPropertiesToReport))}}amplitude.setUserProperties(userPropertiesToReport);return propertiesToReport}function getUTMForNonPaidTarffic(){var utmSourceProperties;var srcCategory;var attributesToLog;var breaker=true;var srcProperty=getURLParameter("src");var referralDomain=document.referrer;var utmSrcListObj=sessionStorage.getItem("UTMSourcesList");if(utmSrcListObj!==null&&referralDomain){utmSrcListObj=utmSrcListObj.replace(/'/g,'"');utmSourceProperties=JSON.parse(utmSrcListObj);var siteURLProp=new URL(referralDomain);var siteName=siteURLProp.hostname.split(".");siteName=siteName[1];for(var key in utmSourceProperties){if(utmSourceProperties.hasOwnProperty(key)){var category=utmSourceProperties[key].split(",");for(var i=0;i<category.length;i++){if(key==="SOCIALSITES"){if(category[i]===siteName){srcCategory="SS";breaker=false;break}}else if(key==="SEARCHENGINES"){if(category[i]===siteName){srcCategory="SE";breaker=false;break}}}if(breaker===false){break}}}if(srcCategory!=="SS"&&srcCategory!=="SE"){srcCategory="NA"}attributesToLog=setUTMSrcParameters(srcCategory,siteName,srcProperty);return attributesToLog}}function setUTMSrcParameters(category,referrer,src){var referrer=eval("referrer");var value=category;var utmSourceEventPropertiesToLog={};var utmSourceUserPropertiesToLog={};switch(value){case"AFFILIATES":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="p-affiliates";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"DISPLAY":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="p-web-display";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"EMAIL":utmSourceEventPropertiesToLog["utm_source"]="email";utmSourceEventPropertiesToLog["utm_medium"]="e-email";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"INTERNAL":utmSourceEventPropertiesToLog["utm_source"]="web";utmSourceEventPropertiesToLog["utm_medium"]="e-internal";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"MOBILE":utmSourceEventPropertiesToLog["utm_source"]="app";utmSourceEventPropertiesToLog["utm_medium"]="e-app";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"OTHER":utmSourceEventPropertiesToLog["utm_source"]="other";utmSourceEventPropertiesToLog["utm_medium"]="e-other";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"RETAIL":utmSourceEventPropertiesToLog["utm_source"]="retail";utmSourceEventPropertiesToLog["utm_medium"]="e-retail";utmSourceEventPropertiesToLog["utm_campaign"]=src;case"SEARCHENGINES":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="p-web-serp";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"SOCIALSITES":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="p-social";utmSourceEventPropertiesToLog["utm_campaign"]=src;break;case"SS":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="e-social";utmSourceEventPropertiesToLog["utm_campaign"]="organic-social";break;case"SE":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="e-web-serp";utmSourceEventPropertiesToLog["utm_campaign"]="organic-search";break;case"NA":utmSourceEventPropertiesToLog["utm_source"]=referrer;utmSourceEventPropertiesToLog["utm_medium"]="e-web";utmSourceEventPropertiesToLog["utm_campaign"]="organic-web";break}utmSourceUserPropertiesToLog=Object.assign({},utmSourceEventPropertiesToLog);Object.keys(utmSourceUserPropertiesToLog).forEach((function(key){var newkey="last_"+key;utmSourceUserPropertiesToLog[newkey]=utmSourceUserPropertiesToLog[key];delete utmSourceUserPropertiesToLog[key]}));if(Object.getOwnPropertyNames(utmSourceUserPropertiesToLog).length!==0){sessionStorage.setItem("ampUTMParam",JSON.stringify(utmSourceEventPropertiesToLog));sessionStorage.setItem("ampUserUTMParam",JSON.stringify(utmSourceUserPropertiesToLog))}setIntialUserIdentify(utmSourceEventPropertiesToLog);return[utmSourceEventPropertiesToLog,utmSourceUserPropertiesToLog]}function setUtmSrcParameter(pageEventAttr){if(ampUTMObj){for(var propertyName in ampUTMObj){pageEventAttr[propertyName]=ampUTMObj[propertyName];if(!getCookieValue(propertyName)){setCookieInMinutes(propertyName,ampUTMObj[propertyName],30)}}}if(src_parameter){amplitude.setUserProperties(src_parameter);pageEventAttr["src_parameter"]=src_parameter}}function setReferrerParameter(pageEventAttr){var ampReferrerObj=eval("ampReferrerObj");if(ampReferrerObj){for(var propertyName in ampReferrerObj){if(ampReferrerObj.hasOwnProperty(propertyName)){pageEventAttr[propertyName]=ampReferrerObj[propertyName]}}}}function logPageEvent(){var removeList=["send-money-option","send-inmate-start","billpay-start","billpaystart","price-estimator","topupstart","history","cruise","login"];var ignoreSummaryObjList=["history","send-money-option","price-estimator"];var pageNameMap={"collectid.pep":"political-affiliation","collectid.sdq":"additional-information","register-step1":"register_us_step1","register-step2":"register_us_step2","collectid.choose":"eid-verification",mobilereload:"mobile-reload",pickupcashair:"pickup-cash-air","pickupcashair-globalcollectid":"pickup-cash-air-global-collectid",completeyourprofile:"complete-your-profile",pickupcashglobalcollectid:"pickup-cash-global-collect-id","confirmcard-3d":"confirm-card-3d","confirmbank-pwm":"confirm-bank-pwm",sendinmatestart:"send-inmate-start","collectid.collect":"collectid-collect","collectid.confirm":"collectid-confirm",kycoption:"kyc-option","kycoption-duc":"kyc-option-duc","kycoption-verify":"kyc-option-verify","kycoption-duc-upload-id":"kyc-option-duc-upload-id","kycoption-duc-upload-proofofAddres":"kyc-options-duc-upload-proof-of-addres",paymentprocessing:"payment-processing",mywu:"my-wu",globalcollectid:"global-collectid","menu-myreceivers":"menu-my-receivers","cashpickupair-receipt":"cash-pickup-air-receipt","tracktransfer-success":"track-transfer-success",tracktransfer:"track-transfer",cancelreview:"cancel-review","redirect-start":"update-delivery-method",evprofileconfirmation:"ev-profile-confirmation",cookieInformation:"cookie-information","refer-friend":"refer-a-friend",sendmoneyoption:"send-money-option","send-money":"send-money-option",verificationoptions:"video-kyc-instructions",success:"kyc-noninline-notification"};checkNameChangeCancelTransferFlow();var pageEventAttr=getAnalyticsData();if(ignoreSummaryObjList.indexOf(pageEventAttr.page_name)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false)}if(removeList.indexOf(pageEventAttr.page_name)!==-1){sessionStorage.removeItem("wuAmplitudeSMO_receiverCountry");sessionStorage.removeItem("wuAmplitudeSMO_sendReceiveLock");sessionStorage.removeItem("wuAmplitudeSMO_fundsIn");sessionStorage.removeItem("wuAmplitudeSMO_fundsOut");sessionStorage.removeItem("wuAmplitude_biller");sessionStorage.removeItem("wuAmplitude_sendAmount");oldCountryCode="";oldFundsOut="";oldFundsIn="";getProviderId();getWuSource();getPartnerName()}if(sessionStorage.getItem("userSelectedCountry")){pageEventAttr["user_selected_country"]=sessionStorage.getItem("userSelectedCountry")?.toLowerCase()}if(sessionStorage.getItem("currentFlow")){pageEventAttr["user_action"]=sessionStorage.getItem("currentFlow")}if(sessionStorage.getItem("loginType")){pageEventAttr["login_mode"]=sessionStorage.getItem("loginType")}sessionStorage.removeItem("wuAmplitude_useSummaryObj");sessionStorage.removeItem("wuAmplitude_useNameChangeObj");sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");if(pageEventAttr.page_name){if(pageNameMap[pageEventAttr.page_name]){pageEventAttr.page_name=pageNameMap[pageEventAttr.page_name]}if(pageEventAttr.page_name=="retailcancelcode"){pageEventAttr.page_name="cancel-reason"}else if(pageEventAttr.page_name=="cancelreceipt"){pageEventAttr.page_name="cancel-confirmation"}else if(pageEventAttr.page_name=="txn-name-edit"){pageEventAttr.page_name="edit-receiver-name"}else if(pageEventAttr.page_name=="namechangereview"){pageEventAttr.page_name="edit-receiver-name-review"}else if(pageEventAttr.page_name=="namechangereceipt"){pageEventAttr.page_name="edit-receiver-name-confirmation"}else if(pageEventAttr.page_name=="retailcallcc"){pageEventAttr.page_name="edit-receiver-name-error"}else if(pageEventAttr.page_name==="billpay-start"||pageEventAttr.page_name==="billpaystart"){pageEventAttr.page_name="bill-payment"}else if(pageEventAttr.page_name==="receiver-payment"){pageEventAttr.page_name="receiver-payment"}else if(pageEventAttr.page_name==="redirect-receiver"&&sessionStorage.getItem("flowType")==="RASD"){pageEventAttr.page_name="redirect-receiver-review"}else if(pageEventAttr.page_name=="shareinfo"){pageEventAttr.page_name="receiver-assist-redirection-success"}else if(pageEventAttr.page_name=="anonymous-complaints"){pageEventAttr.page_name="mx-claim-form"}else if(pageEventAttr.page_name==="rd-review"){pageEventAttr.page_name="receiver-review";if(sessionStorage.getItem("senderRedirect")==="true"){pageEventAttr.page_name="review-sender-redirection"}else{pageEventAttr.page_name="receiver-review"}}else if(pageEventAttr.page_name==="rd-status"&&sessionStorage.getItem("senderRedirect")!=="true"){pageEventAttr.page_name="receiver-redirect-status"}else if(pageEventAttr.page_name==="fraud-resources"){let countryCode=getURLParameter("country")||getCookieValue("AKCountry");pageEventAttr.page_name=countryCode+"-fraud-resource-center"}else if(pageEventAttr.page_name==="ev-profile-confirmation"){pageEventAttr["kyc_option"]="eid"}if(pageEventAttr.page_name=="rd-status"&&sessionStorage.getItem("senderRedirect")==="true"){if(sessionStorage.getItem("redirectStatus")==="Success"){pageEventAttr.page_name="sender-redirection-success"}else{pageEventAttr.page_name="sender-redirection-failure"}}if(pageEventAttr.page_name==="track-transfer-success"){var userType=JSON.parse(sessionStorage.getItem("TransactionInquiryResponse"));if(_.has(userType,"statusDetails.transactionIdentifier")){pageEventAttr["user_type"]=userType.statusDetails.transactionIdentifier.toLowerCase()}if(_.get(userType,"statusDetails.statusLabel")&&_.get(userType,"transactionStatus")){pageEventAttr["mtcn_status"]=_.get(userType,"statusDetails.statusLabel")+" - "+_.get(userType,"transactionStatus")}else{pageEventAttr["mtcn_status"]=_.get(userType,"transactionStatus")?_.get(userType,"transactionStatus"):_.get(userType,"statusDetails.statusLabel")}}if(sessionStorage.getItem("userJourney")=="receiver-redirect"){if(pageEventAttr.page_name=="rd-verify-transfer-details"){pageEventAttr.page_name="verifytransaction"}}var senderCountry="";if(getCookieValue("WUCountryCookie_")){senderCountry=getCookieValue("WUCountryCookie_").toUpperCase()}var isMailingAddressConfirmationEnabled=isFeatureEnabled("MAILING_ADDRESS_CONFIRMATION",senderCountry);if(isMailingAddressConfirmationEnabled&&pageEventAttr.page_name==="additional-information"){pageEventAttr.page_name="mailing-address"}if(pageEventAttr.page_name==="receipt"&&sessionStorage.getItem("scheduled_widget_type")){pageEventAttr["scheduled_widget_type"]=sessionStorage.getItem("scheduled_widget_type")}var page_event="page_"+pageEventAttr.page_name;if(pageEventAttr.page_name!==wuSessionStorage.wuAmplitude_pageName||(pageEventAttr.page_name=="non-transactional"||pageEventAttr.page_name=="currency-converter")){if(pageEventAttr.device_id){amplitude.getInstance().setDeviceId(pageEventAttr.device_id)}updateWULanguage();if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){pageEventAttr.previous_page=wuSessionStorage.wuAmplitude_pageName}if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){pageEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",page_event);previousPageName=pageEventAttr.page_name;setUtmSrcParameter(pageEventAttr);setReferrerParameter(pageEventAttr);logEvents(page_event,pageEventAttr);if(sessionStorage.getItem("forgotPasswordFindAccount")=="true"){page_event+="-find-your-account";logEvents(page_event,pageEventAttr);sessionStorage.setItem("forgotPasswordFindAccount","false")}sessionStorage.setItem("wuAmplitude_pageName",pageEventAttr.page_name);hadoopAnalyticsLogsEvents(page_event,pageEventAttr)}}if(!sessionStorage.getItem("visit-logged-amp")){logAmplitudeVisitEvent(pageEventAttr)}}function checkURLChange(currentUrl){if(currentUrl!==oldURL){if(datahub_config.amplitude&&window.amplitude){var pageName=getCurrentPageNameURL();if(pageName){oldPageName=pageName;oldURL=currentUrl;logPageEvent()}}}}window.setInterval((function(){checkURLChange(window.location.href)}),100);function checkPageNameChange(currentPageName){currentPageName=checkCurrentPageName(currentPageName);if(currentPageName!==oldPageName){if(datahub_config.amplitude&&window.amplitude){oldPageName=currentPageName;logPageEvent()}}}window.setInterval((function(){var pageName=wuSessionStorage.page_name;var url=window.location.href;if(pageName!==undefined&&url.indexOf(".html")===-1){checkPageNameChange(pageName)}}),100);function checkClickAttrName(attrName){var name="property is not available";if(attrName.indexOf("-")){var checkName=attrName.split("-")[0];var list=["button","link","checkbox","tile","icon","toggle","tab","menu","footer","dropdown","info","radio","textbox","bar","option","menuicon","list"];if(list.indexOf(checkName)!==-1){name=attrName}else if(checkName==="popupContainer"){name="button-close-overlay"}}return name}function getAncestorElement(el,attr){while((el=el.parentElement)&&!el.hasAttribute(attr));if(el!==null&&el.hasAttribute(attr)){return checkClickAttrName(el.getAttribute(attr))}return"property is not available"}function setAuthenticateCustomerInfo(request,response){var identify;var _id=response.config.headers?response.config.headers.client_id:"";var _partnerName=countryConfig&&countryConfig.ConfigTemplate&&countryConfig.ConfigTemplate.partner&&countryConfig.ConfigTemplate.partner.name;var _status=response.status===200?"0 (passed)":"1 (failed)";var _referenceId=sessionStorage.getItem("partnerRequestId")?sessionStorage.getItem("partnerRequestId"):null;if(response&&response.status===200){identify=(new amplitude.Identify).setOnce("api_response_code",_status).setOnce("api_reponse_message",getResponseMsg(_partnerName,_status)).setOnce("Partner_name",_partnerName).setOnce("Login_datetime",getTodayDate()).setOnce("Country_Code",request.countryCode).setOnce("customer_reference_id",_referenceId)}else{identify=(new amplitude.Identify).setOnce("api_response_code",_status).setOnce("api_reponse_message",getResponseMsg(_partnerName,_status))}amplitude.getInstance().identify(identify)}function setIntialUserIdentify(data){if(datahub_config.amplitude&&window.amplitude){var identify=(new amplitude.Identify).setOnce("initial_utm_source",data.utm_source).setOnce("initial_utm_medium",data.utm_medium).setOnce("initial_utm_campaign",data.utm_campaign);amplitude.getInstance().identify(identify)}}function getResponseMsg(name,status){var _msg="Single Sign-on for "+name+" "+status;return _msg}function getClickedAttrName(clickedElement){var targetName="property is not available";var attr="amplitude-id";if(clickedElement.hasAttribute(attr)){targetName=checkClickAttrName(clickedElement.getAttribute(attr))}else{if(clickedElement.id){targetName=checkClickAttrName(clickedElement.id)}if(targetName==="property is not available"&&clickedElement.dataset&&clickedElement.dataset.linkname){targetName=checkClickAttrName(clickedElement.dataset.linkname)}if(targetName==="property is not available"){targetName=getAncestorElement(clickedElement,attr)}}return targetName}function logDisplayEvent(attrName){var currentPageName="";if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}if(window.amplitude&&datahub_config.amplitude){var ignoreSummaryObj=["send-money-option","price-estimator","history"];if(ignoreSummaryObj.indexOf(currentPageName)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false)}checkNameChangeCancelTransferFlow();var displayEventAttr=getAnalyticsData();sessionStorage.removeItem("wuAmplitude_useSummaryObj");sessionStorage.removeItem("wuAmplitude_useNameChangeObj");sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");if(attrName!=="property is not available"){var display_event="displayed_["+currentPageName+"]_["+attrName+"]";displayEventAttr.page_name=currentPageName;updateWULanguage();if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){displayEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",display_event);logEvents(display_event,displayEventAttr)}}}function logEvergageExperienceAmplitudeEvent(evergageExperience){const enableR4Mparticle=isR4Mparticle();if(window.amplitude&&datahub_config.amplitude||enableR4Mparticle){logEvergageExperienceInAmplitude(evergageExperience)}else{var interval=setInterval((function(){if(window.amplitude&&datahub_config.amplitude||enableR4Mparticle){clearInterval(interval);logEvergageExperienceInAmplitude(evergageExperience)}}),100)}}function logEvergageExperienceInAmplitude(evergageExperience){var evergageExperiences=JSON.parse(sessionStorage.getItem("evergageExperiences"))||[];var eventAlreadyLogged=false;for(var i=0;i<evergageExperiences.length;i++){if(evergageExperiences[i]["ab_test"]==evergageExperience["ab_test"]&&evergageExperiences[i]["ab_test_variant"]==evergageExperience["ab_test_variant"]){eventAlreadyLogged=true}}if(!eventAlreadyLogged){sessionStorage.setItem("ab_test",evergageExperience["ab_test"]);sessionStorage.setItem("ab_test_variant",evergageExperience["ab_test_variant"]);var currentPageName="";if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}var ignoreSummaryObj=["send-money-option","price-estimator","history"];if(ignoreSummaryObj.indexOf(currentPageName)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false)}checkNameChangeCancelTransferFlow();var displayEventAttr=getAnalyticsData();if(evergageExperience&&evergageExperience["receiver_country"]){displayEventAttr.receiver_country=evergageExperience["receiver_country"]}var userType=getCookieValue("userIdentity")?getCookieValue("userIdentity"):"";if(userType){displayEventAttr["user_pricing_session"]=userType}sessionStorage.removeItem("wuAmplitude_useSummaryObj");sessionStorage.removeItem("wuAmplitude_useNameChangeObj");sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");var display_event=evergageExperience["event_name"]?evergageExperience["event_name"]:"ab_test_experience";displayEventAttr.page_name=currentPageName;window.amplitude&&updateWULanguage();if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){displayEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",display_event);evergageExperiences.push({ab_test:evergageExperience["ab_test"],ab_test_variant:evergageExperience["ab_test_variant"]});sessionStorage.setItem("evergageExperiences",JSON.stringify(evergageExperiences));if(isR4Mparticle()){window.mParticleLogEvent(display_event,display_event,displayEventAttr)}else{logEvents(display_event,displayEventAttr)}}}function logJSErrors(data){var eventInfo={},eventAttr=getAnalyticsData();if(data.error){const enableR4Mparticle=isR4Mparticle();if(window.amplitude&&datahub_config.amplitude||enableR4Mparticle){eventInfo["event_attr"]=eventAttr;eventInfo["error_message"]=data.message;eventInfo["location"]=data.location;if(enableR4Mparticle){window.mParticleLogEvent("js_error","js_error",eventInfo)}else{logEvents("js_error",eventInfo)}}}}function setReceiverCountrySendAmount(clickEventAttr){var receiverCountry=getCookieValue("lastCountry");var sendAmount=getCookieValue("lastSendAmount");if(receiverCountry!==""&&receiverCountry!==undefined){clickEventAttr.receiver_country=receiverCountry.toLowerCase()}if(sendAmount!==""&&sendAmount!==undefined){clickEventAttr.send_amount=sendAmount}}function setReceiverSenderAttributes(clickEventAttr){const pageCalAttributes=window.pageCalAtrributes;if(pageCalAttributes){clickEventAttr.receive_amount=pageCalAttributes.receiveAmount;clickEventAttr.send_currency=pageCalAttributes.senderCurrency;clickEventAttr.receive_currency=pageCalAttributes.reciverCountryCurrency;clickEventAttr.fx=pageCalAttributes.fx;clickEventAttr.fee=pageCalAttributes.fee;clickEventAttr.funds_in=pageCalAttributes.selectedFundsIn;clickEventAttr.funds_out=pageCalAttributes.selectedFundsOut}}function setRmoPageName(e){let href=window.location.href;if(e&&href.endsWith("/rmo-form.html")){return e.target.getAttribute("amplitude-page-id")}}function logClickEvent(e,filterResultCount,periodSelected){var currentPageName="";if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}if(sessionStorage.getItem("userJourney")=="receiver-redirect"){if(currentPageName=="tracktransfer-success"){currentPageName="track-transfer-success"}else if(currentPageName=="rd-verify-transfer-details"){currentPageName="verifytransaction"}else if(currentPageName=="rd-review"){currentPageName="receiver-review"}}var rmoPageName=setRmoPageName(e);if(rmoPageName){currentPageName=rmoPageName}if(window.amplitude&&datahub_config.amplitude||isR4Mparticle()){var clickedElement=window.event&&window.event.srcElement.attributes!==undefined?window.event.srcElement:e.target;if(filterResultCount>-1){if(clickedElement.options){var optionElement=clickedElement.options[clickedElement.selectedIndex]}else{var optionElement=clickedElement.closest("li")}clickedElement=optionElement}var clickedAttrName=getClickedAttrName(clickedElement);if(wuSessionStorage&&wuSessionStorage.amplitude_pageName_MYWU&&clickedAttrName!=="link-apply-reward-promo"&&clickedAttrName!=="link-apply-reward-promo-summryWidget"){currentPageName=wuSessionStorage.amplitude_pageName_MYWU}if(wuSessionStorage&&wuSessionStorage.amplitude_pageName_MYWU&&clickedAttrName=="button-close-pop-up-cross"||clickedAttrName=="button-close-pop-up-bg"){sessionStorage.removeItem("amplitude_pageName_MYWU")}if(clickedAttrName.indexOf("tile-fundsOut-")!==-1){modSMOTile(clickedAttrName,"wuAmplitudeSMO_fundsOut")}if(clickedAttrName.indexOf("tile-fundsIn-")!==-1){modSMOTile(clickedAttrName,"wuAmplitudeSMO_fundsIn")}var ignoreSummaryObj=["send-money-option","price-estimator","history"];if(ignoreSummaryObj.indexOf(currentPageName)!==-1){sessionStorage.setItem("wuAmplitude_useSummaryObj",false);if(clickedAttrName==="button-smo-continue"||clickedAttrName==="button-continue-online"){sessionStorage.removeItem("wuAmplitude_useSummaryObj")}}checkNameChangeCancelTransferFlow();var clickEventAttr=getAnalyticsData();if(e&&e.target&&e.target.id==="payout-info-continue"){const checkedPayout=document.querySelector('[name="payoutOption"]:checked');if(checkedPayout){clickEventAttr["funds_out"]=checkedPayout.getAttribute("data-amplitude-fundsout-text")}}if(sessionStorage.getItem("userSelectedCountry")){clickEventAttr["user_selected_country"]=sessionStorage.getItem("userSelectedCountry")?.toLowerCase()}if(sessionStorage.getItem("currentFlow")){clickEventAttr["user_action"]=sessionStorage.getItem("currentFlow")}if(sessionStorage.getItem("loginType")){clickEventAttr["login_mode"]=sessionStorage.getItem("loginType")}sessionStorage.removeItem("wuAmplitude_useSummaryObj");sessionStorage.removeItem("wuAmplitude_useNameChangeObj");sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");if(clickedAttrName!=="property is not available"){if(JSON.parse(sessionStorage.getItem("popUpOpened"))===true&&sessionStorage.getItem("popUpName")){var popUpName=sessionStorage.getItem("popUpName");var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=popUpName}else if(currentPageName==="send-money-option"&&sessionStorage.getItem("isDirectedCountry")==="Y"&&(document.getElementById("exchangeRate-agents-modal")&&document.getElementById("exchangeRate-agents-modal").classList.contains("in"))||clickedAttrName=="button-close"&&sessionStorage.getItem("isDirectedCountry")==="Y"||clickedAttrName=="button-continue"&&sessionStorage.getItem("isDirectedCountry")==="Y"){var popUpName="directed-services";var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=popUpName}else if((currentPageName==="review"||currentPageName==="history"||currentPageName==="price-estimator"||currentPageName==="send-inmate-start"||currentPageName==="receiver")&&(sessionStorage.getItem("FTCFlag")==="false"&&clickedAttrName=="button-accept")){var popUpName="ftc-fraud-warning";var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=currentPageName}else if(clickedAttrName==="button-close-overlay"){var popUpName=sessionStorage.getItem("popUpName");var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]"}else if(currentPageName==="redirect-receiver"){var popUpName="redirect-receiver";var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=popUpName}else if(currentPageName=="global-collectid"&&clickedAttrName.indexOf("icon-cancel")!==-1){var popUpName="euid";var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=popUpName}else if(clickedAttrName.indexOf("checkbox-offers-news-email")!==-1){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.indexOf("checkbox-offers-news-post")!==-1){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.indexOf("checkbox-offers-news-phone")!==-1){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.indexOf("checkbox-offers-news-sms")!==-1){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.indexOf("checkbox-3rd-party-data-sharing")!==-1){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.indexOf("button-go-to-history")!==-1){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.indexOf("checkbox-offers-news")!==-1){if(currentPageName==="complete-your-profile"){click_event="clicked_[profile-completion-page]_["+clickedAttrName+"]"}if(currentPageName==="profile"){click_event="clicked_[profile]_["+clickedAttrName+"]"}}else if(clickedAttrName.indexOf("checkbox-my-wu")!==-1){if(currentPageName==="complete-your-profile"){click_event="clicked_[complete-your-profile]_["+clickedAttrName+"]"}if(currentPageName==="profile"){click_event="clicked_[profile]_["+clickedAttrName+"]"}}else if(currentPageName=="id-details"&&clickedAttrName.indexOf("button-confirm")!==-1){var popUpName="name-confirmation";var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=popUpName}else if(currentPageName=="id-details"&&clickedAttrName.indexOf("link-go-back")!==-1){var popUpName="name-confirmation";var click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=popUpName}else if(clickedAttrName==="button-close-overlay"){var popUpName=sessionStorage.getItem("page_name");popUpName=popUpName==="verify-email-overlay"?"verify-email-overlay":"signup-overlay";click_event="clicked_["+popUpName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=currentPageName}else if(clickedAttrName==="icon-close"){click_event="close";clickEventAttr["pop-up_name"]="idle-registration"}else if(clickedAttrName==="button-register"){click_event="register";clickEventAttr["pop-up_name"]="idle-registration"}else{var windURL=window.location.href;let splittedStr=windURL.split("/");if(splittedStr[splittedStr.length-2]==="rewards"){if(currentPageName==="rewards-home"||currentPageName==="rewards-dashboard"){clickEventAttr.page_name=`page_${currentPageName}`}if(clickedAttrName.startsWith("button-shop-now")){click_event="clicked_["+currentPageName+"]_[button-shop-now]";let dlId=clickedAttrName.split("-")[3];let mcId_full=clickedAttrName.split("-")[4];let mcId=mcId_full?mcId_full.split("_")[0]:undefined;let dlName=clickedAttrName.split("_")[2];let mcName=clickedAttrName.split("_")[1];clickEventAttr["dealId"]=dlId;clickEventAttr["merchantId"]=mcId;clickEventAttr["dealName"]=dlName;clickEventAttr["merchantName"]=mcName}else if(clickedAttrName.startsWith("button-get-code")){click_event="clicked_["+currentPageName+"]_[button-get-code]";let dlId=clickedAttrName.split("-")[3];let mcId_full=clickedAttrName.split("-")[4];let mcId=mcId_full?mcId_full.split("_")[0]:undefined;let dlName=clickedAttrName.split("_")[2];let mcName=clickedAttrName.split("_")[1];clickEventAttr["dealId"]=dlId;clickEventAttr["merchantId"]=mcId;clickEventAttr["dealName"]=dlName;clickEventAttr["merchantName"]=mcName}else if(clickedAttrName.startsWith("button-")||clickedAttrName.startsWith("icon-")||clickedAttrName.startsWith("link-")){click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]"}else if(clickedAttrName.startsWith("menu-send-money")||clickedAttrName.startsWith("menu-tat")||clickedAttrName.startsWith("menu-find-location")){click_event="clicked_["+clickedAttrName+"]"}else{click_event=clickedAttrName==="menuicon"?"clicked_[link-menu]":"clicked_["+currentPageName+"]_["+clickedAttrName.toLowerCase()+"]"}}else if(clickedAttrName.indexOf("menu-")===0){click_event="clicked_["+clickedAttrName+"]"}else if(windURL.endsWith("/rmo-form.html")){click_event="clicked_["+clickedAttrName+"]"}else{click_event=clickedAttrName==="menuicon"?"clicked_[link-menu]":"clicked_["+currentPageName+"]_["+clickedAttrName.toLowerCase()+"]"}clickEventAttr.page_name=currentPageName;if(optionElement){clickEventAttr.filter_period_selected=periodSelected;clickEventAttr.filter_result_count=filterResultCount}if(click_event==="clicked_[send-money-option]_[button-smo-continue]"&&(clickEventAttr.funds_in===null||clickEventAttr.funds_in===undefined||clickEventAttr.funds_in=="")){clickEventAttr.funds_in="NA"}}window.amplitude&&updateWULanguage();setReceiverCountrySendAmount(clickEventAttr);if(clickedAttrName==="button-continue-summary-calculator"){setReceiverSenderAttributes(clickEventAttr)}if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){clickEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",click_event);var cookiePopupEvent=logCookiePopupClickEvents(e);if(cookiePopupEvent.click_event){click_event=cookiePopupEvent.click_event;clickEventAttr=cookiePopupEvent.clickEventAttr}hadoopAnalyticsLogsEvents(click_event,clickEventAttr);setUtmSrcParameter(clickEventAttr);setReferrerParameter(clickEventAttr);var mparticleElementName=e.target&&e.target.closest("[mparticle-event-name]");var mparticleEventName=mparticleElementName&&mparticleElementName.getAttribute("mparticle-event-name");const stateMParticle=sessionStorage.getItem("stateMParticle")||findMparticleState();if(stateMParticle!=="r4mparticle"){logEvents(click_event,clickEventAttr)}if(mparticleEventName&&window.mParticle&&window.mParticleLogEvent){if(clickEventAttr&&clickEventAttr["sender_country"]&&typeof clickEventAttr["sender_country"]==="string"){clickEventAttr["sender_country"]=clickEventAttr["sender_country"].toUpperCase()}window.mParticleLogEvent(mparticleEventName,click_event,clickEventAttr)}}}}function hadoopAnalyticsLogsEvents(eventName,eventAttr){if(isEventKeyInHadoopAnalytics(eventName)){var hadoopEvents=getHadoopAnalyticsEventsData();var hadoopAnalyticsEventName=hadoopEvents[eventName];var hadoopEventAttr=getHadoopAnalyticsData(hadoopAnalyticsEventName,eventAttr);sendToHadoopAnalytics(hadoopEventAttr)}}function isEventKeyInHadoopAnalytics(eventName){var hadoopEvents=getHadoopAnalyticsEventsData();var isKeyAvailable=Object.keys(hadoopEvents).filter((function(key){return key===eventName}));return isKeyAvailable.length?true:false}function isEventValueInHadoopAnalytics(eventName){var isValueAvailable=Object.keys(hadoopAnalyticsApiEvents).filter((function(key){return hadoopAnalyticsApiEvents[key]===eventName}));return isValueAvailable.length?true:false}function getHadoopAnalyticsData(eventName,eventAttr){var subscriptionId;var subscriptionExpiryDate;var campaignName;if(eventName==="Send money validation completed"){eventName=eventAttr.event_name?eventAttr.event_name:eventName;campaignName=eventAttr.campaign_name?eventAttr.campaign_name:undefined;subscriptionId=eventAttr.subscription_id?eventAttr.subscription_id:undefined;subscriptionExpiryDate=eventAttr.subscription_expiry_date?eventAttr.subscription_expiry_date:undefined}else{subscriptionId=isEventValueInHadoopAnalytics(eventName)?eventAttr.promoCampaignSubscriptionId:getCookieValue("promoCampaignSubscriptionId");subscriptionExpiryDate=isEventValueInHadoopAnalytics(eventName)?eventAttr.promoCampaignSubscriptionEndDate:getCookieValue("promoCampaignSubscriptionEndDate");campaignName=sessionStorage.getItem("serverSidePromoCampaignName")||sessionStorage.getItem("promoPricingCampaignNameUrlParam")||sessionStorage.getItem("promoPricingCampaignName")}var sessionId=eventAttr.session_id?eventAttr.session_id:eventAttr.device_id?eventAttr.device_id:"";var channel=getChannel();var hadoopAnalyticRequestData={event:eventName,timestamp:Date.now(),channel:{name:channel.name,version:channel.version},user:{device_id:eventAttr.device_id?eventAttr.device_id:"",session_id:sessionId,logged_in:eventAttr.logged_in?eventAttr.logged_in:"",customer_id:customerId?customerId:undefined,campaign_name:campaignName?campaignName:undefined,subscription_id:subscriptionId?subscriptionId:undefined,subscription_expiry_date:subscriptionExpiryDate?subscriptionExpiryDate:undefined,transaction_count:getTransactionCount()},page:{name:eventAttr.page_name?eventAttr.page_name:"",exchange_rate:eventAttr.exchange_rate?eventAttr.exchange_rate:"",funds_in:eventAttr.funds_in?eventAttr.funds_in:"",funds_out:eventAttr.funds_out?eventAttr.funds_out:"",receiving_amount:eventAttr.receive_amount?eventAttr.receive_amount:"",receiving_currency:eventAttr.receive_currency?eventAttr.receive_currency:"",receiving_country:eventAttr.receiver_country?eventAttr.receiver_country:"",sending_amount:eventAttr.send_amount?eventAttr.send_amount:"",sending_country:eventAttr.sender_country?eventAttr.sender_country:"",sending_currency:eventAttr.send_currency?eventAttr.sender_country:"",transfer_fee:eventAttr.transfer_fee?eventAttr.transfer_fee:""}};var requestObj={records:[{key:hadoopAnalyticRequestData.user.session_id,value:hadoopAnalyticRequestData}]};return requestObj}function getChannel(){var channel={};var applicationName=sessionStorage.getItem("applicationName");var userJourney=getURLParameter("cusType");if(applicationName==="PPS"||userJourney==="PPS"){channel["name"]="Cruise";channel["type"]="PPS";channel["version"]="9740"}else{channel["name"]="Western Union";channel["type"]="WEB";channel["version"]="9Z00"}return channel}function getTransactionCount(){var transactionHistory=sessionStorage.getItem("transactionHistoryResp");var transactionCount=transactionHistory&&JSON.parse(transactionHistory)instanceof Array?JSON.parse(transactionHistory).length:0;return transactionCount}function getBaseUrl(){var domainURL=window.location.host;var bMock=sessionStorage.getItem("bMock")==="true";if(window.location.host.indexOf("localhost")>-1){if(bMock){domainURL="wudispatcher-dev11.devwesternunion.com"}else{domainURL="wudispatcher-qa11.qawesternunion.com"}}var baseUrl="https://"+domainURL;return baseUrl}function sendToHadoopAnalytics(data){var baseUrl=getBaseUrl();var endPoint="/event/push";var fullUrl=baseUrl+endPoint;var request=new XMLHttpRequest;request.open("POST",fullUrl,true);request.setRequestHeader("Content-Type","application/vnd.kafka.json.v2+json; charset=UTF-8");request.onload=function(){if(this.status===200){var data=this.response;console.log("Hadoop Analytics Resp- ",data)}};request.onerror=function(jqXHR,textStatus,errorThrown){console.log("Hadoop Analytics Error- ",errorThrown)};request.send(data)}function hadoopAnalyticsSuccessCallback(data,textStatus,jqXHR){}function hadoopAnalyticsErrorCallback(jqXHR,textStatus,errorThrown){}function logErrorEvent(fieldLabel,fieldErrorMsg){var currentPageName="";if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}var error_event="error_validation_"+currentPageName;const enableR4Mparticle=isR4Mparticle();if(window.amplitude&&datahub_config.amplitude||enableR4Mparticle){var errorEventAttr=getAnalyticsData();errorEventAttr["field_label"]=fieldLabel;errorEventAttr.page_name=currentPageName;window.amplitude&&updateWULanguage();if(enableR4Mparticle){window.mParticleLogEvent(error_event,error_event,errorEventAttr)}else{logEvents(error_event,errorEventAttr)}}}function logCookieNotificationEvent(){if(window.amplitude){var clickEventAttr=getAnalyticsData();clickEventAttr["wu_cookie_preference"]="m";logEvents("message_cookiesettings",clickEventAttr);sessionStorage.setItem("wuAmplitude_previousEvent","message_cookiesettings")}}function getCookiePreferenceSelected(){var cookieSelectedRadio=document.querySelector("input[name=wu-option-cookie-opt]:checked")&&document.querySelector("input[name=wu-option-cookie-opt]:checked").value;var wu_cookie_preference;if(cookieSelectedRadio==="CKTXNL+CKPERF+CKMKTG"){wu_cookie_preference="m"}else if(cookieSelectedRadio==="CKTXNL+CKPERF"){wu_cookie_preference="p"}else if(cookieSelectedRadio==="CKTXNL"){wu_cookie_preference="t"}return wu_cookie_preference}function manageCookiePopupEvent(){if(window.amplitude){var clickEventAttr=getAnalyticsData();getCookiePreferenceSelected()?clickEventAttr["wu_cookie_preference"]=getCookiePreferenceSelected():clickEventAttr["wu_cookie_preference"]="m";logEvents("pop-up_[managecookies]",clickEventAttr);sessionStorage.setItem("wuAmplitude_previousEvent","pop-up_[managecookies]")}}function logCookiePopupClickEvents(e){if(window.amplitude||isR4Mparticle()){var clickedElement=window.event&&window.event.srcElement.attributes!==undefined?window.event.srcElement:e.target;var clickedAttrName=getClickedAttrName(clickedElement);var clickEventAttr=getAnalyticsData();var click_event="";if(clickedAttrName==="link-managecookies"){click_event="clicked_[cookiesettings]_["+clickedAttrName+"]"}if(clickedAttrName==="footer-changecookiesettings"){click_event="clicked_["+clickedAttrName+"]"}if(clickedAttrName==="radio-marketing"){click_event="clicked_[managecookies]_["+clickedAttrName+"]"}if(clickedAttrName==="radio-performance"){click_event="clicked_[managecookies]_["+clickedAttrName+"]"}if(clickedAttrName==="radio-transactional"){click_event="clicked_[managecookies]_["+clickedAttrName+"]"}if(clickedAttrName==="icon-cookie-popup-close"||clickedAttrName==="button-cookie-popup-close"){click_event="clicked_[managecookies]_["+clickedAttrName+"]";getCookiePreferenceSelected()?clickEventAttr["wu_cookie_preference"]=getCookiePreferenceSelected():clickEventAttr["wu_cookie_preference"]="m"}return{click_event:click_event,clickEventAttr:clickEventAttr}}}function logPopUpEvent(){var currentPageName="";if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}const enableR4Mparticle=isR4Mparticle();if(window.amplitude&&datahub_config.amplitude||enableR4Mparticle){var clickEventAttr=getAnalyticsData();sessionStorage.removeItem("wuAmplitude_useSummaryObj");sessionStorage.removeItem("wuAmplitude_useNameChangeObj");sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");var popUpName=sessionStorage.getItem("popUpName");clickEventAttr["funds_in"]=popUpName;if(currentPageName==="send-money-option"&&sessionStorage.getItem("isDirectedCountry")==="Y"&&document.getElementById("exchangeRate-agents-modal")&&document.getElementById("exchangeRate-agents-modal").classList.contains("in")){popUpName="directed-services"}else if((currentPageName==="review"||currentPageName==="price-estimator"||currentPageName==="send-inmate-start"||currentPageName==="receiver")&&sessionStorage.getItem("FTCFlag")==="true"||currentPageName==="history"&&document.querySelector(".fraud-popup-modal")&&document.querySelector(".fraud-popup-modal").classList.contains("in")){var popUpName="ftc-fraud-warning"}else if(currentPageName==="redirect-receiver"){var popUpName="redirect-receiver"}else if(currentPageName==="receipt"&&sessionStorage.getItem("isJamaicaD2B")){var popUpName="receipt-ask-receiver-to-register"}else if(currentPageName==="receiverredirectstatus"&&sessionStorage.getItem("isJamaicaD2B")){var popUpName="sender-redirection-success-ask-receiver-to-register"}var popup_event;var popup_element;if(currentPageName==="send-money-option"&&sessionStorage.getItem("FTCFlag")!="true"){var popup_event="pop-up_["+"smo-fundsin-instructions"+"]"}else if(popUpName==="registration"){popup_event="pop-up_showInformation";clickEventAttr["pop-up_name"]="idle-registration";popup_element="idle-registration"}else{var popup_event="pop-up_["+popUpName+"]"}clickEventAttr.page_name=currentPageName;window.amplitude&&updateWULanguage();if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){clickEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",popup_event);if(sessionStorage.getItem("userSelectedCountry")){clickEventAttr["user_selected_country"]=sessionStorage.getItem("userSelectedCountry")?.toLowerCase()}setUtmSrcParameter(clickEventAttr);setReferrerParameter(clickEventAttr);if(popUpName!==null&&popUpName!==undefined){if(enableR4Mparticle){window.mParticleLogEvent(popup_event,popup_element||popup_event,clickEventAttr)}else{logEvents(popup_event,clickEventAttr)}}}}function logTabEvent(e){var currentPageName="";if(e.keyCode===9){if(wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName){currentPageName=wuSessionStorage.wuAmplitude_pageName}else if(previousPageName){currentPageName=previousPageName}else{currentPageName="page name did not catch"}if(window.amplitude&&datahub_config.amplitude&&(currentPageName==="register"||currentPageName==="new-payment")||isR4Mparticle()){var clickedElement=window.event&&window.event.srcElement.attributes!==undefined?window.event.srcElement:e.target;var clickedAttrName=getClickedAttrName(clickedElement);var clickEventAttr=getAnalyticsData();if(clickedAttrName!=="property is not available"&&clickedAttrName!=="button-continue"){var click_event="clicked_["+currentPageName+"]_["+clickedAttrName+"]";clickEventAttr.page_name=currentPageName;window.amplitude&&updateWULanguage();if(wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent){clickEventAttr.previous_event=wuSessionStorage.wuAmplitude_previousEvent}sessionStorage.setItem("wuAmplitude_previousEvent",click_event);logCookiePopupClickEvents(e)}}}}function logAppDownloadBanner(){let appDownloadBanner=document.querySelector("#app-smart-banner");let isBannerVisible=appDownloadBanner&&getComputedStyle(appDownloadBanner).display==="block";if(isBannerVisible&&sessionStorage.getItem("popUpName")=="download-app-banner"){window.logPopUpEvent()}}function logEvergageAbTest(){if(JSON.parse(sessionStorage.getItem("customAppBanner"))&&logEvergageExperienceAmplitudeEvent){logEvergageExperienceAmplitudeEvent({ab_test:"us_web_app-banner",ab_test_variant:"us_web_app-banner_code"})}}function logAmplitudeVisitEvent(pageEventAttr){const visitEventObj={};if(Object.getOwnPropertyNames(pageEventAttr).length!==0){for(const propertyName in pageEventAttr){if(VISIT_EVENT_PROPS.indexOf(propertyName)!==-1&&propertyName!=="wu_device_id"){visitEventObj[propertyName]=pageEventAttr[propertyName]}}}logEvents("customer_visit",visitEventObj);document.cookie="visit-logged-amp=true;path=/;domain="+window.location.hostname}logAppDownloadBanner();function resetWuAmplitudePageName(){window.sessionStorage.removeItem("wuAmplitude_pageName")}resetWuAmplitudePageName();document.onclick=function(e,filterResultCount,periodSelected){logClickEvent(e,filterResultCount,periodSelected)};document.onkeyup=function(e){logTabEvent(e)};
